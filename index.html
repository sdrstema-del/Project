<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="dark" />
  <title>–ö–∞–∫ –≤–ª–∏—è—é—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –∏–≥—Ä—ã –Ω–∞ —á–µ–ª–æ–≤–µ–∫–∞</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300..900&family=JetBrains+Mono:wght@300..800&display=swap" rel="stylesheet">

  <!-- Libraries (CDN) -->
  <script defer src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/@studio-freight/lenis@1.0.42/bundled/lenis.min.js"></script>

  <style>
    :root {
      --bg: #070812;
      --panel: rgba(14, 16, 30, .72);
      --panel2: rgba(9, 10, 18, .62);
      --stroke: rgba(255,255,255,.10);
      --stroke2: rgba(255,255,255,.16);
      --text: rgba(255,255,255,.90);
      --muted: rgba(255,255,255,.66);
      --faint: rgba(255,255,255,.46);
      --brand: #7c3aed;  /* violet */
      --brand2: #22d3ee; /* cyan  */
      --good: #34d399;
      --bad: #fb7185;
      --warn: #fbbf24;
      --shadow: 0 22px 70px rgba(0,0,0,.55);
      --shadow2: 0 10px 30px rgba(0,0,0,.45);
      --radius: 22px;
      --radius2: 16px;
      --max: 1180px;
      --content: 760px;
      --fs: 16px;
      --lh: 1.75;
      --measure: 72ch;
      --focus: 0 0 0 3px rgba(34,211,238,.25), 0 0 0 1px rgba(124,58,237,.35) inset;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      font-size: var(--fs);
      line-height: var(--lh);
      color: var(--text);
      background: radial-gradient(1200px 800px at 20% 20%, rgba(124,58,237,.22), transparent 60%),
                  radial-gradient(1000px 700px at 80% 30%, rgba(34,211,238,.18), transparent 55%),
                  radial-gradient(900px 700px at 55% 95%, rgba(251,113,133,.14), transparent 60%),
                  var(--bg);
      overflow-x: hidden;
    }

    /* WebGL backdrop */
    #bg3d {
      position: fixed;
      inset: 0;
      z-index: -3;
    }
    .noise {
      pointer-events: none;
      position: fixed;
      inset: 0;
      z-index: -2;
      opacity: .11;
      mix-blend-mode: overlay;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='140' height='140' filter='url(%23n)' opacity='.35'/%3E%3C/svg%3E");
    }
    .scanlines {
      pointer-events: none;
      position: fixed;
      inset: 0;
      z-index: -1;
      opacity: .09;
      background: repeating-linear-gradient(
        to bottom,
        rgba(255,255,255,.06) 0px,
        rgba(255,255,255,.06) 1px,
        transparent 2px,
        transparent 6px
      );
    }

    /* Top progress */
    .top-progress {
      position: fixed;
      top: 0;
      left: 0;
      height: 3px;
      width: 0%;
      background: linear-gradient(90deg, var(--brand), var(--brand2));
      z-index: 50;
      box-shadow: 0 0 18px rgba(34,211,238,.35);
    }

    /* Layout */
    .shell {
      position: relative;
      display: grid;
      grid-template-columns: 340px minmax(0, 1fr);
      gap: 26px;
      max-width: var(--max);
      margin: 0 auto;
      padding: 22px 18px 90px;
    }
    @media (max-width: 980px) {
      .shell { grid-template-columns: 1fr; }
    }

    /* Sidebar */
    .side {
      position: sticky;
      top: 16px;
      align-self: start;
      height: calc(100dvh - 32px);
      display: flex;
      flex-direction: column;
      gap: 14px;
    }
    @media (max-width: 980px) {
      .side { position: relative; height: auto; }
    }

    .panel {
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow2);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      overflow: hidden;
    }
    .panel .hd {
      padding: 14px 16px 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: linear-gradient(90deg, rgba(124,58,237,.16), rgba(34,211,238,.10));
    }
    .brand {
      display: flex; align-items: center; gap: 10px;
      font-weight: 800;
      letter-spacing: .2px;
    }
    .sig {
      width: 34px; height: 34px;
      border-radius: 12px;
      background: radial-gradient(circle at 35% 35%, rgba(255,255,255,.65), rgba(255,255,255,.08)),
                  linear-gradient(135deg, rgba(124,58,237,.9), rgba(34,211,238,.8));
      box-shadow: 0 0 0 1px rgba(255,255,255,.14) inset, 0 14px 40px rgba(124,58,237,.22);
      position: relative;
      overflow: hidden;
    }
    .sig:after {
      content: "";
      position: absolute;
      inset: -60%;
      background: conic-gradient(from 180deg, transparent, rgba(255,255,255,.38), transparent);
      animation: spin 5.5s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    .kbd {
      font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
      font-size: 12px;
      padding: 4px 8px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,.14);
      color: rgba(255,255,255,.80);
      background: rgba(0,0,0,.25);
    }

    .side .body {
      padding: 14px 16px 16px;
    }

    .toc {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 6px;
    }
    .toc a {
      text-decoration: none;
      color: rgba(255,255,255,.74);
      padding: 10px 10px;
      border-radius: 14px;
      border: 1px solid transparent;
      background: rgba(0,0,0,.12);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      transition: transform .18s ease, border-color .18s ease, background .18s ease;
    }
    .toc a:hover {
      transform: translateY(-1px);
      border-color: rgba(34,211,238,.22);
      background: rgba(34,211,238,.07);
    }
    .toc a.active {
      color: rgba(255,255,255,.92);
      border-color: rgba(124,58,237,.35);
      background: linear-gradient(90deg, rgba(124,58,237,.20), rgba(34,211,238,.10));
      box-shadow: 0 0 0 1px rgba(255,255,255,.06) inset;
    }
    .dot {
      width: 10px; height: 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.22);
      box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset;
      flex: none;
    }
    .toc a.active .dot {
      background: linear-gradient(135deg, var(--brand), var(--brand2));
      box-shadow: 0 0 18px rgba(34,211,238,.28);
    }

    .hud {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 12px;
    }
    .chip {
      padding: 10px 12px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      display: flex;
      flex-direction: column;
      gap: 2px;
      min-height: 54px;
    }
    .chip b {
      font-size: 13px;
      color: rgba(255,255,255,.86);
      font-weight: 700;
    }
    .chip span {
      font-size: 12px;
      color: rgba(255,255,255,.62);
    }

    .side-actions {
      display: flex;
      gap: 10px;
      margin-top: 12px;
    }
    .btn {
      appearance: none;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.25);
      color: rgba(255,255,255,.86);
      padding: 11px 12px;
      border-radius: 16px;
      cursor: pointer;
      font-weight: 650;
      letter-spacing: .15px;
      transition: transform .18s ease, border-color .18s ease, background .18s ease, box-shadow .18s ease;
      flex: 1;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      user-select: none;
    }
    .btn:hover {
      transform: translateY(-1px);
      border-color: rgba(34,211,238,.25);
      background: rgba(34,211,238,.08);
    }
    .btn:focus-visible { outline: none; box-shadow: var(--focus); }
    .btn.primary {
      background: linear-gradient(135deg, rgba(124,58,237,.85), rgba(34,211,238,.70));
      border-color: rgba(255,255,255,.14);
      box-shadow: 0 14px 40px rgba(124,58,237,.22);
    }
    .btn.primary:hover {
      background: linear-gradient(135deg, rgba(124,58,237,.95), rgba(34,211,238,.80));
    }

    /* Main */
    main {
      min-width: 0;
    }

    .hero {
      padding: 18px 0 16px;
    }
    .hero-card {
      border-radius: calc(var(--radius) + 8px);
      border: 1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
    }
    .hero-card:before {
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(900px 420px at 18% 18%, rgba(124,58,237,.24), transparent 55%),
        radial-gradient(700px 360px at 88% 28%, rgba(34,211,238,.18), transparent 55%),
        radial-gradient(900px 420px at 40% 110%, rgba(251,113,133,.12), transparent 60%);
      filter: blur(0px);
      opacity: .95;
      pointer-events:none;
    }
    .hero-inner {
      position: relative;
      padding: 28px 24px 22px;
      display: grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 18px;
      align-items: start;
    }
    @media (max-width: 980px) {
      .hero-inner { grid-template-columns: 1fr; }
    }

    .glitch {
      position: relative;
      font-size: clamp(34px, 4vw, 56px);
      line-height: 1.05;
      margin: 0;
      letter-spacing: -0.02em;
      font-weight: 900;
      text-shadow: 0 0 24px rgba(34,211,238,.18);
    }
    .glitch::before,
    .glitch::after {
      content: attr(data-text);
      position: absolute;
      inset: 0;
      opacity: .65;
      pointer-events: none;
      clip-path: inset(0 0 0 0);
      mix-blend-mode: screen;
      filter: saturate(1.2);
    }
    .glitch::before {
      transform: translate(2px, 0);
      color: rgba(34,211,238,.70);
      animation: glitchA 3.2s infinite linear alternate-reverse;
    }
    .glitch::after {
      transform: translate(-2px, 0);
      color: rgba(251,113,133,.58);
      animation: glitchB 2.6s infinite linear alternate-reverse;
    }
    @keyframes glitchA {
      0% { clip-path: inset(10% 0 65% 0); }
      10% { clip-path: inset(28% 0 40% 0); }
      20% { clip-path: inset(5% 0 75% 0); }
      30% { clip-path: inset(55% 0 22% 0); }
      40% { clip-path: inset(14% 0 62% 0); }
      50% { clip-path: inset(42% 0 34% 0); }
      60% { clip-path: inset(64% 0 12% 0); }
      70% { clip-path: inset(20% 0 55% 0); }
      80% { clip-path: inset(74% 0 6% 0); }
      90% { clip-path: inset(34% 0 38% 0); }
      100% { clip-path: inset(12% 0 65% 0); }
    }
    @keyframes glitchB {
      0% { clip-path: inset(70% 0 8% 0); }
      12% { clip-path: inset(12% 0 72% 0); }
      24% { clip-path: inset(48% 0 24% 0); }
      36% { clip-path: inset(22% 0 52% 0); }
      48% { clip-path: inset(66% 0 10% 0); }
      60% { clip-path: inset(30% 0 46% 0); }
      72% { clip-path: inset(6% 0 78% 0); }
      84% { clip-path: inset(58% 0 18% 0); }
      100% { clip-path: inset(16% 0 64% 0); }
    }

    .sub {
      margin: 14px 0 0;
      color: rgba(255,255,255,.78);
      font-size: 16px;
      max-width: 62ch;
    }

    .hero-cta {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 16px;
    }

    .badges {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }
    .badge {
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.22);
      padding: 8px 10px;
      border-radius: 999px;
      font-size: 12px;
      color: rgba(255,255,255,.76);
      box-shadow: 0 0 0 1px rgba(255,255,255,.04) inset;
      user-select: none;
    }
    .badge.hot {
      background: linear-gradient(135deg, rgba(124,58,237,.45), rgba(34,211,238,.28));
      border-color: rgba(255,255,255,.14);
      color: rgba(255,255,255,.86);
    }

    .mini {
      margin-top: 12px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.20);
      padding: 12px 12px;
      display: grid;
      gap: 10px;
    }
    .mini-row {
      display:flex; align-items:center; justify-content: space-between; gap: 10px;
      font-size: 12px;
      color: rgba(255,255,255,.70);
    }
    .bar {
      height: 8px;
      border-radius: 999px;
      background: rgba(255,255,255,.08);
      overflow: hidden;
      border: 1px solid rgba(255,255,255,.10);
    }
    .bar > i {
      display: block;
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--brand), var(--brand2));
      box-shadow: 0 0 18px rgba(34,211,238,.22);
    }

    /* Content cards */
    section {
      scroll-margin-top: 16px;
    }
    .card {
      margin-top: 18px;
      border-radius: var(--radius);
      border: 1px solid rgba(255,255,255,.10);
      background: var(--panel);
      box-shadow: var(--shadow2);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      overflow: hidden;
      transform-style: preserve-3d;
    }
    .card .card-inner {
      padding: 22px 22px 24px;
    }

    .kicker {
      font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
      font-size: 12px;
      color: rgba(255,255,255,.66);
      letter-spacing: .12em;
      text-transform: uppercase;
      display: inline-flex;
      align-items: center;
      gap: 10px;
    }
    .kicker:before {
      content:"";
      width: 20px; height: 2px;
      background: linear-gradient(90deg, var(--brand), var(--brand2));
      border-radius: 999px;
      box-shadow: 0 0 18px rgba(34,211,238,.18);
    }

    h2 {
      margin: 10px 0 12px;
      font-size: clamp(22px, 2.3vw, 30px);
      line-height: 1.2;
      letter-spacing: -0.01em;
    }
    h3 {
      margin: 18px 0 10px;
      font-size: 18px;
      letter-spacing: -0.01em;
    }
    p {
      margin: 10px 0;
      color: rgba(255,255,255,.80);
      max-width: var(--measure);
    }
    .lead {
      font-size: 18px;
      color: rgba(255,255,255,.82);
      max-width: 70ch;
    }

    /* Stats blocks */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap: 12px;
      margin: 14px 0 12px;
    }
    @media (max-width: 720px) {
      .stats-grid { grid-template-columns: 1fr; }
    }
    .stat-card {
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22);
      padding: 16px 16px;
      position: relative;
      overflow:hidden;
    }
    .stat-card:before {
      content:"";
      position:absolute; inset:-1px;
      background: radial-gradient(480px 220px at 20% 25%, rgba(34,211,238,.14), transparent 55%),
                  radial-gradient(520px 240px at 80% 30%, rgba(124,58,237,.16), transparent 55%);
      opacity: .9;
      pointer-events:none;
    }
    .stat-number {
      position: relative;
      font-size: 30px;
      font-weight: 900;
      letter-spacing: -0.02em;
      background: linear-gradient(90deg, rgba(255,255,255,.92), rgba(34,211,238,.86));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-shadow: 0 0 30px rgba(34,211,238,.12);
    }
    .stat-label {
      position: relative;
      margin-top: 4px;
      color: rgba(255,255,255,.72);
      font-size: 13px;
    }

    /* Effects grid */
    .effects-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap: 12px;
      margin: 14px 0 8px;
    }
    @media (max-width: 980px) {
      .effects-grid { grid-template-columns: 1fr; }
    }
    .effect-card {
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22);
      padding: 16px 16px;
      position: relative;
      overflow: hidden;
      min-height: 118px;
    }
    .effect-card.positive:before {
      content:"";
      position:absolute; inset:-1px;
      background: radial-gradient(520px 240px at 18% 20%, rgba(52,211,153,.16), transparent 55%),
                  radial-gradient(520px 240px at 84% 40%, rgba(34,211,238,.14), transparent 58%);
      opacity: .95;
      pointer-events:none;
    }
    .effect-card.negative:before {
      content:"";
      position:absolute; inset:-1px;
      background: radial-gradient(520px 240px at 18% 20%, rgba(251,113,133,.16), transparent 55%),
                  radial-gradient(520px 240px at 84% 40%, rgba(251,191,36,.10), transparent 58%);
      opacity: .95;
      pointer-events:none;
    }
    .effect-icon {
      position: relative;
      font-size: 22px;
      width: 38px; height: 38px;
      border-radius: 14px;
      display: grid;
      place-items: center;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: 0 16px 40px rgba(0,0,0,.25);
    }
    .effect-card h3 {
      position: relative;
      margin: 12px 0 6px;
      font-size: 16px;
      color: rgba(255,255,255,.90);
    }
    .effect-card p {
      position: relative;
      margin: 0;
      color: rgba(255,255,255,.70);
      font-size: 13px;
      max-width: 46ch;
    }

    /* Games */
    .game-examples {
      display: grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap: 14px;
      margin-top: 14px;
    }
    @media (max-width: 980px) {
      .game-examples { grid-template-columns: 1fr; }
    }
    .game-card {
      border-radius: 18px;
      overflow: hidden;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22);
      display: flex;
      flex-direction: column;
      min-height: 360px;
      transform-style: preserve-3d;
    }
    .game-image {
      width: 100%;
      height: 140px;
      object-fit: cover;
      filter: saturate(1.12) contrast(1.04);
      transform: translateZ(1px);
    }
    .game-content {
      padding: 14px 14px 16px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .game-title {
      font-weight: 900;
      letter-spacing: -0.01em;
      font-size: 18px;
    }
    .game-feature {
      color: rgba(255,255,255,.74);
      font-size: 13px;
    }
    .game-feature strong {
      color: rgba(255,255,255,.90);
    }
    .game-info {
      margin-top: 10px;
      padding: 10px 10px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
    }
    .game-info h4 {
      margin: 0 0 8px;
      font-size: 13px;
      color: rgba(255,255,255,.86);
      letter-spacing: .01em;
    }
    .cs2-feature {
      font-size: 12px;
      color: rgba(255,255,255,.72);
      margin: 6px 0;
    }

    /* Story */
    .story-lead {
      margin: 6px 0 6px;
      color: rgba(255,255,255,.70);
      font-size: 13px;
      font-weight: 500;
    }
    .story-after {
      color: rgba(255,255,255,.76);
      border-left: 2px solid rgba(34,211,238,.35);
      padding-left: 12px;
    }

    /* Interactive embeds */
    .embed {
      margin-top: 14px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22);
      overflow: hidden;
    }
    .embed .embed-hd {
      padding: 12px 14px;
      display:flex; align-items:center; justify-content: space-between; gap: 10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: linear-gradient(90deg, rgba(124,58,237,.14), rgba(34,211,238,.08));
      color: rgba(255,255,255,.82);
      font-weight: 750;
      font-size: 13px;
    }
    .embed .embed-bd {
      padding: 12px 14px 14px;
    }
    .range {
      display:flex; gap: 10px; align-items:center; flex-wrap: wrap;
      font-size: 12px;
      color: rgba(255,255,255,.72);
      margin-top: 10px;
    }
    input[type="range"] {
      width: 240px;
      accent-color: var(--brand2);
    }

    /* Quiz */
    .quiz-section .quiz-container {
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      border-radius: 18px;
      padding: 16px;
    }
    .quiz-q {
      font-weight: 850;
      font-size: 16px;
      letter-spacing: -0.01em;
      margin-bottom: 10px;
    }
    .quiz-opt {
      display:flex; align-items:flex-start; gap: 10px;
      padding: 10px 10px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      cursor: pointer;
      transition: transform .15s ease, border-color .15s ease, background .15s ease;
      margin: 8px 0;
      user-select: none;
    }
    .quiz-opt:hover {
      transform: translateY(-1px);
      border-color: rgba(34,211,238,.22);
      background: rgba(34,211,238,.06);
    }
    .quiz-opt input { margin-top: 3px; }
    .quiz-opt.correct {
      border-color: rgba(52,211,153,.35);
      background: rgba(52,211,153,.10);
    }
    .quiz-opt.wrong {
      border-color: rgba(251,113,133,.35);
      background: rgba(251,113,133,.10);
    }
    .quiz-actions {
      display:flex; gap: 10px; flex-wrap: wrap; margin-top: 12px;
    }
    .quiz-actions .btn { flex: 0 0 auto; }

    .toast {
      position: fixed;
      right: 18px;
      bottom: 18px;
      width: min(420px, calc(100vw - 36px));
      z-index: 80;
      display: grid;
      gap: 10px;
    }
    .toast-item {
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.42);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-shadow: var(--shadow2);
      padding: 12px 12px;
      display:flex; gap: 10px; align-items:flex-start;
      transform: translateY(10px);
      opacity: 0;
      animation: toastIn .28s ease forwards;
    }
    @keyframes toastIn {
      to { transform: translateY(0); opacity: 1; }
    }
    .toast-ic {
      width: 36px; height: 36px; border-radius: 14px;
      display:grid; place-items:center;
      background: linear-gradient(135deg, rgba(124,58,237,.55), rgba(34,211,238,.35));
      border: 1px solid rgba(255,255,255,.12);
      flex:none;
    }
    .toast-item b { display:block; font-size: 13px; }
    .toast-item span { display:block; font-size: 12px; color: rgba(255,255,255,.70); margin-top: 2px; }

    /* Modals */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.55);
      z-index: 90;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 18px;
    }
    .overlay.show { display: flex; }
    .modal {
      width: min(860px, 100%);
      border-radius: 22px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(10, 11, 20, .78);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      overflow: hidden;
    }
    .modal .mh {
      padding: 14px 16px;
      display:flex; justify-content: space-between; align-items:center; gap: 12px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      background: linear-gradient(90deg, rgba(124,58,237,.18), rgba(34,211,238,.10));
    }
    .modal .mh b {
      font-size: 14px;
      letter-spacing: .2px;
    }
    .modal .mb {
      padding: 16px 16px 18px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    @media (max-width: 780px) {
      .modal .mb { grid-template-columns: 1fr; }
    }
    .field {
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22);
      padding: 12px 12px;
    }
    .field label {
      display:block;
      font-size: 12px;
      color: rgba(255,255,255,.70);
      margin-bottom: 8px;
    }
    .field .row {
      display:flex; align-items:center; justify-content: space-between; gap: 10px;
    }
    .field small { color: rgba(255,255,255,.58); font-size: 11px; }
    .toggle {
      display:flex; align-items:center; gap: 10px;
      cursor: pointer;
      user-select: none;
    }
    .toggle input {
      width: 18px; height: 18px;
      accent-color: var(--brand2);
    }

    /* Sources */
    .sources {
      margin-top: 10px;
    }
    .source-list {
      margin: 10px 0 0;
      padding-left: 18px;
    }
    .source-list li {
      margin: 10px 0;
      color: rgba(255,255,255,.74);
    }
    .source-list a {
      color: rgba(34,211,238,.86);
      text-decoration: none;
    }
    .source-list a:hover {
      text-decoration: underline;
    }

    /* Motion prefs */
    @media (prefers-reduced-motion: reduce) {
      .glitch::before, .glitch::after { animation: none; }
      .sig:after { animation: none; }
      * { scroll-behavior: auto !important; }
    }
  
/* ===== Ultra v2: Cinematic / Interactive ===== */
.cinematic-divider{
  width: min(1100px, calc(100% - 48px));
  margin: 26px auto 18px;
  filter: drop-shadow(0 0 24px rgba(124,58,237,.25)) drop-shadow(0 0 20px rgba(34,211,238,.18));
  opacity: .95;
}
.cinematic-divider svg{ display:block; width:100%; height:84px; }
.cinematic-divider .cd-glow{
  fill: rgba(124,58,237,.16);
}
.cinematic-divider .cd-line{
  fill:none;
  stroke: rgba(34,211,238,.55);
  stroke-width: 2.2;
  stroke-linecap: round;
  stroke-dasharray: 14 10;
  animation: cdDash 5.5s linear infinite;
}
@keyframes cdDash { to { stroke-dashoffset: -120; } }

.pullquote{
  position: relative;
  border-radius: 18px;
  padding: 18px 18px 14px;
  background: linear-gradient(180deg, rgba(124,58,237,.18), rgba(0,0,0,.35));
  border: 1px solid rgba(124,58,237,.28);
  box-shadow: 0 18px 70px rgba(0,0,0,.45);
  overflow: hidden;
}
.pullquote:before{
  content:"";
  position:absolute; inset:-2px;
  background: radial-gradient(600px 220px at 10% 0%, rgba(34,211,238,.25), transparent 60%),
              radial-gradient(600px 220px at 90% 10%, rgba(124,58,237,.25), transparent 60%);
  opacity:.9;
  pointer-events:none;
}
.pq-label{ font-size: 12px; color: var(--muted); letter-spacing:.12em; text-transform: uppercase; position:relative; }
.pq-text{ font-size: 18px; line-height:1.35; margin-top: 10px; position:relative; }
.pq-actions{ display:flex; gap:10px; margin-top: 12px; position:relative; flex-wrap:wrap; }
.btn.tiny{ padding: 8px 10px; font-size: 12px; border-radius: 12px; }

.callout{
  border-radius: 18px;
  background: rgba(15, 15, 20, .55);
  border: 1px solid rgba(255,255,255,.08);
  padding: 14px 14px 10px;
  box-shadow: 0 14px 60px rgba(0,0,0,.45);
}
.callout-head{ display:flex; align-items:center; justify-content:space-between; gap:12px; }
.callout-body p{ margin: 10px 0 0 0; color: var(--muted); }

.story-wrap{ margin-top: 18px; }
.story-main{
  display:grid;
  grid-template-columns: 1.6fr 1fr;
  gap: 18px;
}
@media (max-width: 980px){
  .story-main{ grid-template-columns: 1fr; }
}
.story-card{
  border-radius: 22px;
  background: rgba(10,10,14,.62);
  border: 1px solid rgba(255,255,255,.08);
  padding: 18px;
  box-shadow: 0 26px 100px rgba(0,0,0,.55);
  position: relative;
  overflow:hidden;
}
.story-card:after{
  content:"";
  position:absolute; inset:-2px;
  background:
    radial-gradient(800px 260px at 10% -10%, rgba(34,211,238,.18), transparent 60%),
    radial-gradient(800px 260px at 110% 10%, rgba(124,58,237,.22), transparent 60%);
  pointer-events:none;
}
.story-top{ display:flex; align-items:flex-start; justify-content:space-between; gap: 14px; position:relative; }
.story-title{ font-weight: 750; letter-spacing:.02em; }
.story-stats{ display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end; }
.pill{
  padding: 8px 10px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(0,0,0,.28);
  font-size: 12px;
}
.story-text{
  position:relative;
  margin-top: 14px;
  font-size: 16px;
  line-height: 1.6;
  color: rgba(255,255,255,.92);
}
.story-choices{ position:relative; margin-top: 14px; display:grid; gap: 10px; }
.choice{
  padding: 12px 12px;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(0,0,0,.28);
  cursor: pointer;
  transition: transform .18s ease, border-color .18s ease, background .18s ease;
}
.choice:hover{
  transform: translateY(-1px);
  border-color: rgba(34,211,238,.35);
  background: rgba(34,211,238,.08);
}
.choice .c-title{ font-weight: 700; }
.choice .c-meta{ margin-top: 6px; font-size: 12px; color: var(--muted); display:flex; gap:10px; flex-wrap:wrap; }
.story-controls{ position:relative; margin-top: 14px; display:flex; gap: 10px; flex-wrap: wrap; }
.story-footnote{ position:relative; margin-top: 14px; }

.story-side{ display:grid; gap: 18px; }
.story-log{
  border-radius: 22px;
  background: rgba(10,10,14,.52);
  border: 1px solid rgba(255,255,255,.08);
  padding: 16px;
  box-shadow: 0 22px 90px rgba(0,0,0,.55);
}
.story-log-head{ display:flex; align-items:center; justify-content:space-between; }
.story-path{ margin-top: 10px; display:grid; gap: 10px; }
.path-item{
  padding: 10px 12px;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,.08);
  background: rgba(0,0,0,.22);
}
.path-item b{ display:block; }
.divider-mini{
  height:1px; background: rgba(255,255,255,.08);
  margin: 14px 0;
}
.result-grid{
  display:grid; grid-template-columns: repeat(3, 1fr);
  gap: 10px;
}
@media (max-width: 620px){ .result-grid{ grid-template-columns: 1fr; } }
.result-card{
  padding: 12px;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(0,0,0,.24);
}
.result-card span{ display:block; font-size: 12px; color: var(--muted); }
.result-card b{ display:block; margin-top: 6px; font-size: 14px; }

.cinematic-break{
  margin-top: 18px;
  border-radius: 22px;
  padding: 16px 16px;
  background: linear-gradient(90deg, rgba(124,58,237,.18), rgba(34,211,238,.10));
  border: 1px solid rgba(255,255,255,.10);
  display:flex; align-items:center; justify-content:space-between; gap: 14px;
}
.cb-right{ display:flex; gap: 12px; flex-wrap:wrap; justify-content:flex-end; }
.hud-mini{ display:flex; gap: 8px; align-items:center; padding: 8px 10px; border-radius: 999px; background: rgba(0,0,0,.25); border: 1px solid rgba(255,255,255,.10); }

.missions{
  margin-top: 14px;
  border-radius: 22px;
  padding: 14px;
  background: rgba(10,10,14,.55);
  border: 1px solid rgba(255,255,255,.08);
  box-shadow: 0 22px 90px rgba(0,0,0,.55);
}
.missions-head{ display:flex; align-items:center; justify-content:space-between; gap: 10px; }
.rank{ display:flex; flex-direction:column; gap: 4px; }
.rank-badge{
  display:inline-flex; width:max-content;
  padding: 6px 10px;
  border-radius: 999px;
  border: 1px solid rgba(34,211,238,.25);
  background: rgba(34,211,238,.08);
  font-weight: 750;
  letter-spacing: .02em;
}
.rank-sub{ font-size: 12px; color: var(--muted); }
.side-actions .btn{ width: 100%; }
.missions-list{ margin-top: 12px; display:grid; gap: 10px; }
.mission{
  display:grid;
  grid-template-columns: 10px 1fr auto;
  gap: 10px;
  align-items:flex-start;
  padding: 12px;
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,.08);
  background: rgba(0,0,0,.20);
}
.m-dot{
  width: 10px; height: 10px; border-radius: 999px;
  background: rgba(255,255,255,.18);
  margin-top: 5px;
}
.mission.done .m-dot{
  background: linear-gradient(90deg, rgba(124,58,237,1), rgba(34,211,238,1));
  box-shadow: 0 0 18px rgba(34,211,238,.30);
}
.m-title{ font-weight: 700; }
.m-desc{ margin-top: 4px; font-size: 12px; color: var(--muted); }
.m-state{ font-size: 12px; color: rgba(255,255,255,.9); }

.share-fab{
  position: fixed;
  z-index: 60;
  left: -9999px; top: -9999px;
  opacity: 0;
  transform: translateY(6px);
  transition: opacity .15s ease, transform .15s ease;
  pointer-events:none;
}
.share-fab.show{
  opacity: 1;
  transform: translateY(0);
  pointer-events:auto;
}

</style>
</head>

<body>
  <canvas id="bg3d" aria-hidden="true"></canvas>
  <div class="noise" aria-hidden="true"></div>
  <div class="scanlines" aria-hidden="true"></div>
  <div class="top-progress" id="topProgress"></div>

  <div class="shell">
    <aside class="side">
      <div class="panel">
        <div class="hd">
          <div class="brand">
            <div class="sig" aria-hidden="true"></div>
            <div>
              <div style="font-size:13px; line-height: 1.1;">Gaming Longread</div>
              <div style="font-size:12px; color: rgba(255,255,255,.62); margin-top: 2px;">–ù–∞–≤–∏–≥–∞—Ü–∏—è –∏ HUD</div>
            </div>
          </div>
          <div class="kbd" title="–û—Ç–∫—Ä—ã—Ç—å –∫–æ–º–∞–Ω–¥–Ω—É—é –ø–∞–ª–∏—Ç—Ä—É">Ctrl K</div>
        </div>
        <div class="body">
          <div style="font-size:12px; color: rgba(255,255,255,.68);">
            –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è: <span class="kbd">/</span> –ø–æ–∏—Å–∫ ‚Ä¢ <span class="kbd">T</span> —Ç–µ–º–∞ ‚Ä¢ <span class="kbd">S</span> –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
          </div>

          <nav class="toc" id="toc">
            <a href="#stats" data-id="stats"><span style="display:flex; align-items:center; gap:10px;"><i class="dot"></i>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span><span class="kbd" style="opacity:.7">1</span></a>
            <a href="#positive" data-id="positive"><span style="display:flex; align-items:center; gap:10px;"><i class="dot"></i>–ü–æ–ª—å–∑–∞</span><span class="kbd" style="opacity:.7">2</span></a>
            <a href="#negative" data-id="negative"><span style="display:flex; align-items:center; gap:10px;"><i class="dot"></i>–í—Ä–µ–¥</span><span class="kbd" style="opacity:.7">3</span></a>
            <a href="#examples" data-id="examples"><span style="display:flex; align-items:center; gap:10px;"><i class="dot"></i>–ü—Ä–∏–º–µ—Ä—ã</span><span class="kbd" style="opacity:.7">4</span></a>
            <a href="#story" data-id="story"><span style="display:flex; align-items:center; gap:10px;"><i class="dot"></i>Story Mode</span><span class="kbd" style="opacity:.7">5</span></a>
            <a href="#quiz" data-id="quiz"><span style="display:flex; align-items:center; gap:10px;"><i class="dot"></i>–¢–µ—Å—Ç</span><span class="kbd" style="opacity:.7">6</span></a>
            <a href="#conclusion" data-id="conclusion"><span style="display:flex; align-items:center; gap:10px;"><i class="dot"></i>–í—ã–≤–æ–¥—ã</span><span class="kbd" style="opacity:.7">7</span></a>
            <a href="#sources" data-id="sources"><span style="display:flex; align-items:center; gap:10px;"><i class="dot"></i>–ò—Å—Ç–æ—á–Ω–∏–∫–∏</span><span class="kbd" style="opacity:.7">8</span></a>
          </nav>

          <div class="hud">
            <div class="chip">
              <b id="rtLabel">‚è±Ô∏è –í—Ä–µ–º—è</b>
              <span id="rtValue">‚Äî</span>
            </div>
            <div class="chip">
              <b>üéØ –ü—Ä–æ–≥—Ä–µ—Å—Å</b>
              <span id="progValue">0%</span>
            </div>
            <div class="chip">
              <b>üèÜ –ê—á–∏–≤–∫–∏</b>
              <span id="achValue">0</span>
            </div>
            <div class="chip">
              <b>üèÖ –†–∞–Ω–≥</b>
              <span id="rankValue">Recruit</span>
            </div>
            <div class="chip">
              <b>üß≠ –°–µ–∫—Ü–∏—è</b
              <span id="secValue">‚Äî</span>
            </div>
          </div>

          <div class="mini" aria-label="–ú–∏–Ω–∏-—Ä–∞–¥–∞—Ä —á—Ç–µ–Ω–∏—è">
            <div class="mini-row"><span>–†–∞–¥–∞—Ä —á—Ç–µ–Ω–∏—è</span><span id="radarPct">0%</span></div>
            <div class="bar"><i id="radarBar"></i></div>
          
          <div class="missions" aria-label="–ú–∏—Å—Å–∏–∏ —á–∏—Ç–∞—Ç–µ–ª—è">
            <div class="missions-head">
              <div class="rank">
                <span class="rank-badge" id="rankBadge">Recruit</span>
                <span class="rank-sub" id="rankSub">0/3 –º–∏—Å—Å–∏–π</span>
              </div>
              <button class="btn tiny" id="resetProgressBtn" title="–°–±—Ä–æ—Å–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å">–°–±—Ä–æ—Å</button>
            </div>
            <div class="missions-list">
              <div class="mission" data-m="read">
                <i class="m-dot" aria-hidden="true"></i>
                <div class="m-body">
                  <div class="m-title">–ü—Ä–æ–π—Ç–∏ 60% –º–∞—Ç–µ—Ä–∏–∞–ª–∞</div>
                  <div class="m-desc">–ü—Ä–æ–≥—Ä–µ—Å—Å —á—Ç–µ–Ω–∏—è –∏ —Å–µ–∫—Ü–∏–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</div>
                </div>
                <span class="m-state" id="mRead">0%</span>
              </div>
              <div class="mission" data-m="story">
                <i class="m-dot" aria-hidden="true"></i>
                <div class="m-body">
                  <div class="m-title">–ó–∞–≤–µ—Ä—à–∏—Ç—å Story Mode</div>
                  <div class="m-desc">–ü—Ä–æ–π–¥–∏—Ç–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –≤–µ—Ç–∫—É –∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.</div>
                </div>
                <span class="m-state" id="mStory">‚Äî</span>
              </div>
              <div class="mission" data-m="quiz">
                <i class="m-dot" aria-hidden="true"></i>
                <div class="m-body">
                  <div class="m-title">–ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç</div>
                  <div class="m-desc">–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö —Ç–µ–∑–∏—Å–æ–≤ –ª–æ–Ω–≥—Ä–∏–¥–∞.</div>
                </div>
                <span class="m-state" id="mQuiz">‚Äî</span>
              </div>
            </div>
          </div>

          <div class="side-actions">
            <button class="btn primary" id="startBtn">‚ñ∂ –°—Ç–∞—Ä—Ç</button>
            <button class="btn" id="settingsBtn">‚öô –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
          </div>
        </div>
      </div>
    </aside>

    <main>
      <div class="hero">
        <div class="hero-card" id="top">
          <div class="hero-inner">
            <div>
              <h1 class="glitch" data-text="–ö–∞–∫ –≤–ª–∏—è—é—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –∏–≥—Ä—ã –Ω–∞ —á–µ–ª–æ–≤–µ–∫–∞">–ö–∞–∫ –≤–ª–∏—è—é—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –∏–≥—Ä—ã –Ω–∞ —á–µ–ª–æ–≤–µ–∫–∞</h1>
              <p class="sub">–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤–ª–∏—è–Ω–∏—è –∏–≥—Ä –Ω–∞ –ø—Å–∏—Ö–∏–∫—É, —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞–≤—ã–∫–∏, –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∏ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—É—é –∂–∏–∑–Ω—å —á–µ–ª–æ–≤–µ–∫–∞</p>
              <div class="hero-cta">
                <button class="btn primary" id="jumpToRead">–ß–∏—Ç–∞—Ç—å (Scroll)</button>
                <button class="btn" id="paletteBtn">–ö–æ–º–∞–Ω–¥–Ω–∞—è –ø–∞–ª–∏—Ç—Ä–∞</button>
                <button class="btn" id="toggleThemeBtn">–¢–µ–º–∞: Neon</button>
              </div>
            </div>
            <div>
              <div class="badges" aria-label="–ö–ª—é—á–µ–≤—ã–µ —Ç–µ–≥–∏">
                <span class="badge hot">UI / Motion</span>
                <span class="badge">WebGL</span>
                <span class="badge">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤</span>
                <span class="badge">–î–∞–Ω–Ω—ã–µ</span>
              </div>
              <div class="mini" style="margin-top: 14px;">
                <div class="mini-row"><span>–°–ª–æ–∂–Ω–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è</span><span id="densityLabel">‚Äî</span></div>
                <div class="mini-row"><span>–¢–µ–∫—Å—Ç</span><span id="textModeLabel">Comfort</span></div>
                <div class="mini-row"><span>–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏</span><span class="kbd">Ctrl K</span></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- CONTENT -->
      <section id="stats" class="card" data-kicker="DATA">
        <div class="card-inner">
          <div class="kicker">DATA ‚Ä¢ –†–´–ù–û–ö</div>
          <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–≤–æ–π –∏–Ω–¥—É—Å—Ç—Ä–∏–∏</h2>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">3.2 –º–ª—Ä–¥</div>
                        <div class="stat-label">–∏–≥—Ä–æ–∫–æ–≤ –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">71%</div>
                        <div class="stat-label">–∏–≥—Ä–æ–∫–æ–≤ —Å—Ç–∞—Ä—à–µ 18 –ª–µ—Ç</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">46%</div>
                        <div class="stat-label">–∂–µ–Ω—â–∏–Ω —Å—Ä–µ–¥–∏ –∏–≥—Ä–æ–∫–æ–≤</div>
                    </div>
                </div>

                <p>–°–æ–≥–ª–∞—Å–Ω–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—é Newzoo, —É–≤–ª–µ—á–µ–Ω–∏–µ –∏–≥—Ä–∞–º–∏ —Å—Ç–∞–ª–æ –º–∞—Å—Å–æ–≤—ã–º —è–≤–ª–µ–Ω–∏–µ–º: –∏–Ω–¥—É—Å—Ç—Ä–∏—è –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞—Å—Ç–∏, –ø—Ä–∏–≤–ª–µ–∫–∞—è –≤—Å–µ –±–æ–ª–µ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é. –°—Ä–µ–¥–Ω–µ—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∏–≥—Ä–æ–∫ —É–¥–µ–ª—è–µ—Ç –∏–≥—Ä–∞–º –æ–∫–æ–ª–æ 7 —á–∞—Å–æ–≤ –≤ –Ω–µ–¥–µ–ª—é, —á—Ç–æ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–æ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –Ω–∞ —Ö–æ–±–±–∏.</p>
          <div class="embed" id="statsViz">
            <div class="embed-hd">
              <span>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è: ¬´7 —á–∞—Å–æ–≤ –≤ –Ω–µ–¥–µ–ª—é¬ª</span>
              <span class="kbd">drag</span>
            </div>
            <div class="embed-bd">
              <canvas id="hoursChart" height="120"></canvas>
              <div class="range">
                <span>–°–º–æ–¥–µ–ª–∏—Ä—É–π—Ç–µ –≤—Ä–µ–º—è –≤ –Ω–µ–¥–µ–ª—é:</span>
                <input type="range" id="hoursRange" min="0" max="30" value="7" />
                <b><span id="hoursVal">7</span> —á/–Ω–µ–¥</b>
                <span style="color: rgba(255,255,255,.55)">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ: —Å–æ–Ω/—Ö–æ–±–±–∏/–∏–≥—Ä—ã</span>
              </div>
            </div>
          </div>
        </div>
      </section>

<div class="cinematic-divider" aria-hidden="true">
  <svg viewBox="0 0 1440 120" preserveAspectRatio="none">
    <path class="cd-glow" d="M0,64 C180,96 360,16 540,48 C720,80 900,112 1080,72 C1260,32 1350,40 1440,56 L1440,120 L0,120 Z"></path>
    <path class="cd-line" d="M0,70 C180,102 360,22 540,54 C720,86 900,118 1080,78 C1260,38 1350,46 1440,62"></path>
  </svg>
</div>

      <section id="positive" class="card" data-kicker="UPSIDE">
        <div class="card-inner">
          <div class="kicker">UPSIDE ‚Ä¢ –ù–ê–í–´–ö–ò</div>
          <h2>–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –∏–≥—Ä</h2>

                <div class="effects-grid">
                    <div class="effect-card positive">
                        <div class="effect-icon">üß†</div>
                        <h3>–ö–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏</h3>
                        <p>–ò–≥—Ä—ã —Ä–∞–∑–≤–∏–≤–∞—é—Ç —Ä–µ–∞–∫—Ü–∏—é, –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –º—ã—à–ª–µ–Ω–∏–µ –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</p>
                    </div>

                    <div class="effect-card positive">
                        <div class="effect-icon">üë•</div>
                        <h3>–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞–≤—ã–∫–∏</h3>
                        <p>–ú–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∏–≥—Ä—ã —É—á–∞—Ç –∫–æ–º–∞–Ω–¥–Ω–æ–π —Ä–∞–±–æ—Ç–µ –∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏</p>
                    </div>

                    <div class="effect-card positive">
                        <div class="effect-icon">üéØ</div>
                        <h3>–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º</h3>
                        <p>–ò–≥—Ä—ã —Ç—Ä–µ–Ω–∏—Ä—É—é—Ç –Ω–∞–≤—ã–∫–∏ –∞–Ω–∞–ª–∏–∑–∞ —Å–∏—Ç—É–∞—Ü–∏–π –∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π</p>
                    </div>
                </div>

                <h3>–ü—Ä–∏–º–µ—Ä –∏–∑ Dota 2:</h3>
                <p>–ß—Ç–æ–±—ã –¥–æ–±–∏—Ç—å—Å—è —É—Å–ø–µ—Ö–∞, –∏–≥—Ä–æ–∫ Dota 2 –¥–æ–ª–∂–µ–Ω –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ä—Ç—É, –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏—è –ø—è—Ç–∏ –æ–ø–ø–æ–Ω–µ–Ω—Ç–æ–≤, –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å –∫–æ–º–∞–Ω–¥–æ–π –∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ç–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è. –≠—Ç–æ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ –∏ –º–Ω–æ–≥–æ–∑–∞–¥–∞—á–Ω–æ—Å—Ç—å, –Ω–æ –∏ —Å—Ç—Ä–µ—Å—Å–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å.</p>
        </div>
      </section>

<div class="cinematic-divider" aria-hidden="true">
  <svg viewBox="0 0 1440 120" preserveAspectRatio="none">
    <path class="cd-glow" d="M0,64 C180,96 360,16 540,48 C720,80 900,112 1080,72 C1260,32 1350,40 1440,56 L1440,120 L0,120 Z"></path>
    <path class="cd-line" d="M0,70 C180,102 360,22 540,54 C720,86 900,118 1080,78 C1260,38 1350,46 1440,62"></path>
  </svg>
</div>

      <section id="negative" class="card" data-kicker="DOWNSIDE">
        <div class="card-inner">
          <div class="kicker">DOWNSIDE ‚Ä¢ –†–ò–°–ö</div>
          <h2>–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –∏–≥—Ä</h2>

                <div class="effects-grid">
                    <div class="effect-card negative">
                        <div class="effect-icon">üòî</div>
                        <h3>–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–∞—á–µ–ª–∏</h3>
                        <p>–°–∏–ª—å–Ω—ã–µ —ç–º–æ—Ü–∏–∏ –æ—Ç –ø–æ–±–µ–¥ –∏ –ø–æ—Ä–∞–∂–µ–Ω–∏–π –º–æ–≥—É—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</p>
                    </div>

                    <div class="effect-card negative">
                        <div class="effect-icon">üïí</div>
                        <h3>–í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã</h3>
                        <p>–ß—Ä–µ–∑–º–µ—Ä–Ω–æ–µ —É–≤–ª–µ—á–µ–Ω–∏–µ –∏–≥—Ä–∞–º–∏ –º–æ–∂–µ—Ç –æ—Ç–Ω–∏–º–∞—Ç—å –≤—Ä–µ–º—è —É –¥—Ä—É–≥–∏—Ö –≤–∞–∂–Ω—ã—Ö –¥–µ–ª</p>
                    </div>

                    <div class="effect-card negative">
                        <div class="effect-icon">üí∏</div>
                        <h3>–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ä–∏—Å–∫–∏</h3>
                        <p>–ú–∏–∫—Ä–æ—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –ª—É—Ç–±–æ–∫—Å—ã –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–º —Ç—Ä–∞—Ç–∞–º</p>
                    </div>
                </div>

                <h3>–ò—Å—Ç–æ—Ä–∏—è –∏–∑ –∂–∏–∑–Ω–∏:</h3>
                <p class="story-lead">–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è, –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É—é—â–∞—è —Ä–∏—Å–∫ —Ä–∞–∑–≤–∏—Ç–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏</p>
                <p>"–ú–æ–π –¥—Ä—É–≥ –∏–∑ 9 –∫–ª–∞—Å—Å–∞ –Ω–∞—á–∞–ª –∏–≥—Ä–∞—Ç—å –≤ Dota 2 –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —Å—Ç–∞–ª –∑–∞–≤–∏—Å–∏–º—ã–º –æ—Ç –¥–æ—Ñ–∞–º–∏–Ω–æ–≤—ã—Ö –≤—Å–ø–ª–µ—Å–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω –ø–æ–ª—É—á–∞–ª –≤–æ –≤—Ä–µ–º—è –∏–≥—Ä—ã. –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –ø–æ–±–µ–¥—ã –æ–Ω —á—É–≤—Å—Ç–≤–æ–≤–∞–ª —Å–∏–ª—å–Ω—É—é —ç–π—Ñ–æ—Ä–∏—é –∏ —Å—Ä–∞–∑—É —Ö–æ—Ç–µ–ª –∏–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞, —á—Ç–æ–±—ã –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —ç—Ç–æ –æ—â—É—â–µ–Ω–∏–µ. –ü–æ—Ä–∞–∂–µ–Ω–∏—è –∂–µ –≤—ã–∑—ã–≤–∞–ª–∏ —É –Ω–µ–≥–æ —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ –∏ –∂–µ–ª–∞–Ω–∏–µ '–æ—Ç—ã–≥—Ä–∞—Ç—å—Å—è'. –°–æ –≤—Ä–µ–º–µ–Ω–µ–º –æ–Ω –Ω–∞—á–∞–ª –ø—Ä–æ–≤–æ–¥–∏—Ç—å –∑–∞ –∏–≥—Ä–æ–π –ø–æ 5-6 —á–∞—Å–æ–≤ –≤ –¥–µ–Ω—å, –µ–≥–æ —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å –≤ —à–∫–æ–ª–µ —É–ø–∞–ª–∞, –∞ –æ–±—â–µ–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥—Ä—É–∑—å—è–º–∏ –ø–æ—á—Ç–∏ –ø—Ä–µ–∫—Ä–∞—Ç–∏–ª–æ—Å—å. –†–æ–¥–∏—Ç–µ–ª–∏ –∑–∞–º–µ—Ç–∏–ª–∏, —á—Ç–æ –æ–Ω —Å—Ç–∞–ª –±–æ–ª–µ–µ –∑–∞–º–∫–Ω—É—Ç—ã–º –∏ —Ä–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª—å–Ω—ã–º, –æ—Å–æ–±–µ–Ω–Ω–æ –∫–æ–≥–¥–∞ –Ω–µ –º–æ–≥ –ø–æ–∏–≥—Ä–∞—Ç—å."</p>
                <p class="story-after">–≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–≥—Ä—ã –∏–∑ —É–≤–ª–µ—á–µ–Ω–∏—è –≤ –ø—Ä–æ–±–ª–µ–º—É, –≤—ã—Ç–µ—Å–Ω—è—é—â—É—é —Ä–µ–∞–ª—å–Ω—É—é –∂–∏–∑–Ω—å –∏ –≤–ª–∏—è—é—â—É—é –Ω–∞ –ø—Å–∏—Ö–æ—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.</p>
          <div class="embed" id="riskSim">
            <div class="embed-hd">
              <span>–°–∏–º—É–ª—è—Ç–æ—Ä —Ä–∏—Å–∫–∞: ¬´—Å–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤ ‚Äî —É–∂–µ –∫—Ä–∞—Å–Ω–∞—è –∑–æ–Ω–∞?¬ª</span>
              <span class="kbd">interactive</span>
            </div>
            <div class="embed-bd">
              <p style="margin:0 0 8px; color: rgba(255,255,255,.72); max-width: 70ch;">
                –≠—Ç–æ –Ω–µ –¥–∏–∞–≥–Ω–æ–∑, –∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è: –ø—Ä–∏ —Ä–æ—Å—Ç–µ –≤—Ä–µ–º–µ–Ω–∏ –∏ —É—Ö—É–¥—à–µ–Ω–∏–∏ —Å–Ω–∞/—É—á—ë–±—ã/—Å–æ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è.
              </p>
              <div class="range">
                <span>–ß–∞—Å—ã –≤ –¥–µ–Ω—å:</span>
                <input type="range" id="riskRange" min="0" max="10" value="2" />
                <b><span id="riskVal">2</span> —á/–¥–µ–Ω—å</b>
              </div>
              <div class="mini" style="margin-top: 12px;">
                <div class="mini-row"><span>–ò–Ω–¥–µ–∫—Å —Ä–∏—Å–∫–∞</span><span id="riskPct">‚Äî</span></div>
                <div class="bar"><i id="riskBar"></i></div>
              </div>
              <p id="riskText" style="margin-top: 10px;"></p>
            </div>
          </div>
        </div>
      </section>

<div class="cinematic-divider" aria-hidden="true">
  <svg viewBox="0 0 1440 120" preserveAspectRatio="none">
    <path class="cd-glow" d="M0,64 C180,96 360,16 540,48 C720,80 900,112 1080,72 C1260,32 1350,40 1440,56 L1440,120 L0,120 Z"></path>
    <path class="cd-line" d="M0,70 C180,102 360,22 540,54 C720,86 900,118 1080,78 C1260,38 1350,46 1440,62"></path>
  </svg>
</div>

      <section id="examples" class="card" data-kicker="CASE STUDIES">
        <div class="card-inner">
          <div class="kicker">CASE STUDIES ‚Ä¢ –ñ–ê–ù–†–´</div>
          <h2>–ü—Ä–∏–º–µ—Ä—ã –≤–ª–∏—è–Ω–∏—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∏–≥—Ä</h2>

                <div class="game-examples">
                    <div class="game-card">
                        <img class="game-image" src="https://cdn.akamai.steamstatic.com/steam/apps/570/header.jpg" />
                        <div class="game-content">
                            <div class="game-title">Dota 2</div>
                            <div class="game-feature"><strong>–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ:</strong> –†–∞–∑–≤–∏—Ç–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ –º—ã—à–ª–µ–Ω–∏—è, –∫–æ–º–∞–Ω–¥–Ω–æ–π —Ä–∞–±–æ—Ç—ã</div>
                            <div class="game-feature"><strong>–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ:</strong> –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å, —Ç–æ–∫—Å–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ</div>
                            <div class="game-feature"><strong>–í—Ä–µ–º—è –º–∞—Ç—á–∞:</strong> 30-60 –º–∏–Ω—É—Ç</div>
                        </div>
                    </div>

                    <div class="game-card">
                        <img class="game-image" src="https://cdn.akamai.steamstatic.com/steam/apps/730/header.jpg" />
                        <div class="game-content">
                            <div class="game-title">Counter-Strike 2</div>
                            <div class="game-feature"><strong>–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ:</strong> –£–ª—É—á—à–µ–Ω–∏–µ —Ä–µ–∞–∫—Ü–∏–∏, —Ç–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –º—ã—à–ª–µ–Ω–∏—è</div>
                            <div class="game-feature"><strong>–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ:</strong> –í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å —Å—Ç—Ä–µ—Å—Å–∞, –∞–≥—Ä–µ—Å—Å–∏—è</div>
                            <div class="game-info">
                                <h4>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ CS2:</h4>
                                <div class="cs2-feature">
                                    <strong>–ö–æ—Ä–æ—Ç–∫–∏–µ —Ä–∞—É–Ω–¥—ã:</strong> –ø–æ 2 –º–∏–Ω—É—Ç—ã –∫–∞–∂–¥—ã–π
                                </div>
                                <div class="cs2-feature">
                                    <strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—É–Ω–¥–æ–≤:</strong> –æ—Ç 15 –¥–æ 30 –∑–∞ –º–∞—Ç—á
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="game-card">
                        <img class="game-image" src="https://main.judgehype.com/images/article-entetes/2025/4251-1758013603.webp" />
                        <div class="game-content">
                            <div class="game-title">World of Warcraft</div>
                            <div class="game-feature"><strong>–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ:</strong> –°–æ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è, –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤</div>
                            <div class="game-feature"><strong>–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ:</strong> –†–∏—Å–∫ –∏–≥—Ä–æ–≤–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –±–æ–ª—å—à–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã</div>
                            <div class="game-feature"><strong>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:</strong> –ú–ú–ûRPG —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –º–∏—Ä–æ–º</div>
                        </div>
                    </div>
                </div>
          <div class="embed" id="filters">
            <div class="embed-hd"><span>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤: —Ñ–∏–ª—å—Ç—Ä –∫–∞—Ä—Ç–æ—á–µ–∫ –ø–æ —ç—Ñ—Ñ–µ–∫—Ç—É</span><span class="kbd">click</span></div>
            <div class="embed-bd">
              <div style="display:flex; gap:10px; flex-wrap:wrap;">
                <button class="btn" data-filter="all">–í—Å–µ</button>
                <button class="btn" data-filter="positive">–ë–æ–ª—å—à–µ –ø–æ–ª—å–∑—ã</button>
                <button class="btn" data-filter="negative">–ë–æ–ª—å—à–µ —Ä–∏—Å–∫–∞</button>
              </div>
              <p style="margin-top: 10px; color: rgba(255,255,255,.66); font-size: 12px;">
                –ü–æ–¥—Å–∫–∞–∑–∫–∞: –Ω–∞–≤–µ–¥–∏—Ç–µ –∫—É—Ä—Å–æ—Ä –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É ‚Äî –≤–∫–ª—é—á–∞–µ—Ç—Å—è 3D-tilt. –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö tilt –æ—Ç–∫–ª—é—á—ë–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
              </p>
            </div>
          </div>
        </div>
      </section>

<div class="cinematic-divider" aria-hidden="true">
  <svg viewBox="0 0 1440 120" preserveAspectRatio="none">
    <path class="cd-glow" d="M0,64 C180,96 360,16 540,48 C720,80 900,112 1080,72 C1260,32 1350,40 1440,56 L1440,120 L0,120 Z"></path>
    <path class="cd-line" d="M0,70 C180,102 360,22 540,54 C720,86 900,118 1080,78 C1260,38 1350,46 1440,62"></path>
  </svg>
</div>

      <section id="story" class="card" data-kicker="STORY">
        <div class="card-inner">
          <div class="card-head">
            <div>
              <div class="kicker">STORY MODE</div>
              <h2>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –≤–µ—Ç–∫–∞: ¬´–ù–µ–¥–µ–ª—è –∏–≥—Ä–æ–∫–∞¬ª</h2>
              <p class="lead">–í—ã –ø—Ä–æ–π–¥—ë—Ç–µ –∫–æ—Ä–æ—Ç–∫–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π –≤—ã–±–æ—Ä–∞: –±–∞–ª–∞–Ω—Å –∏–≥—Ä, —Ä–∞–±–æ—Ç—ã/—É—á—ë–±—ã, —Å–Ω–∞ –∏ —ç–º–æ—Ü–∏–π. –í –∫–æ–Ω—Ü–µ ‚Äî –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä –∏ —Ñ–∏–∫—Å–∏—Ä—É–µ–º–∞—è ¬´–∞—á–∏–≤–∫–∞¬ª.</p>
            </div>
            <div class="meta">
              <div class="meta-item"><span class="dot"></span><span>–í–µ—Ç–≤–ª–µ–Ω–∏–µ</span></div>
              <div class="meta-item"><span class="dot"></span><span>–ò–Ω–¥–µ–∫—Å —Ä–∏—Å–∫–∞</span></div>
              <div class="meta-item"><span class="dot"></span><span>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</span></div>
            </div>
          </div>

          <div class="story-wrap">
            <div class="story-main">
              <div class="story-card">
                <div class="story-top">
                  <div class="story-title">–°—Ü–µ–Ω–∞—Ä–∏–π</div>
                  <div class="story-stats">
                    <span class="pill">–°–æ–Ω: <b id="stSleep">‚Äî</b></span>
                    <span class="pill">–ß–∞—Å—ã –∏–≥—Ä: <b id="stHours">‚Äî</b></span>
                    <span class="pill">–°—Ç—Ä–µ—Å—Å: <b id="stStress">‚Äî</b></span>
                    <span class="pill">–†–∏—Å–∫: <b id="stRisk">‚Äî</b></span>
                  </div>
                </div>

                <div class="story-text" id="storyText">‚Äî</div>

                <div class="story-choices" id="storyChoices"></div>

                <div class="story-controls">
                  <button class="btn" id="storyBackBtn">‚Üê –ù–∞–∑–∞–¥</button>
                  <button class="btn" id="storyRestartBtn">‚Ü∫ –°–Ω–∞—á–∞–ª–∞</button>
                  <button class="btn primary" id="storyFinishBtn" disabled>–ó–∞–≤–µ—Ä—à–∏—Ç—å –≤–µ—Ç–∫—É</button>
                </div>

                <div class="story-footnote">
                  <div class="callout">
                    <div class="callout-head">
                      <b>–ö–∞–∫ —Å—á–∏—Ç–∞–µ—Ç—Å—è ¬´—Ä–∏—Å–∫¬ª?</b>
                      <button class="btn tiny callout-toggle" aria-expanded="false">–ü–æ–∫–∞–∑–∞—Ç—å</button>
                    </div>
                    <div class="callout-body" hidden>
                      <p>–≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –≤–æ–≤–ª–µ—á–µ–Ω–∏—è: —Ä–∏—Å–∫ —Ä–∞—Å—Ç—ë—Ç –ø—Ä–∏ –¥–µ—Ñ–∏—Ü–∏—Ç–µ —Å–Ω–∞, –≤—ã—Å–æ–∫–æ–π –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ –∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ–π —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ –ø–æ—Ä–∞–∂–µ–Ω–∏—è. –≠—Ç–æ –Ω–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –Ω–µ –∫–ª–∏–Ω–∏—á–µ—Å–∫–∞—è —à–∫–∞–ª–∞.</p>
                      <p class="mono">risk = f(hours, sleep, stress, control)</p>
                    </div>
                  </div>
                </div>
              </div>

              <div class="story-side">
                <div class="pullquote">
                  <div class="pq-label">Pull quote</div>
                  <div class="pq-text">¬´–ë–∞–ª–∞–Ω—Å ‚Äî —ç—Ç–æ –Ω–µ –æ—Ç–∫–∞–∑ –æ—Ç –∏–≥—Ä, –∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–µ–º, —ç–º–æ—Ü–∏—è–º–∏ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º¬ª</div>
                  <div class="pq-actions">
                    <button class="btn tiny pq-copy" data-copy="–ë–∞–ª–∞–Ω—Å ‚Äî —ç—Ç–æ –Ω–µ –æ—Ç–∫–∞–∑ –æ—Ç –∏–≥—Ä, –∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–µ–º, —ç–º–æ—Ü–∏—è–º–∏ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button class="btn tiny pq-share" data-share="#story">–°—Å—ã–ª–∫–∞</button>
                  </div>
                </div>

                <div class="story-log">
                  <div class="story-log-head">
                    <b>–í–∞—à –ø—É—Ç—å</b>
                    <span class="kbd" id="storyStepLabel">‚Äî</span>
                  </div>
                  <div class="story-path" id="storyPath"></div>

                  <div class="divider-mini"></div>

                  <div class="story-result" id="storyResult" style="display:none;">
                    <h3 style="margin:0 0 8px 0;">–ò—Ç–æ–≥</h3>
                    <p id="storySummary" style="margin:0 0 12px 0; color: var(--muted);"></p>
                    <div class="result-grid">
                      <div class="result-card"><span>–ë–∞–ª–∞–Ω—Å</span><b id="resBalance">‚Äî</b></div>
                      <div class="result-card"><span>–†–∏—Å–∫</span><b id="resRisk">‚Äî</b></div>
                      <div class="result-card"><span>–°–æ–≤–µ—Ç</span><b id="resTip">‚Äî</b></div>
                    </div>
                    <button class="btn primary" id="storyClaimBtn">–ó–∞—Å—á–∏—Ç–∞—Ç—å –º–∏—Å—Å–∏—é</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="cinematic-break">
              <div class="cb-left">
                <h3 style="margin:0 0 6px 0;">–ú–∏—Å—Å–∏—è: ¬´–û—Å–æ–∑–Ω–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º¬ª</h3>
                <p style="margin:0; color: var(--muted);">–ü—Ä–æ–π–¥–∏—Ç–µ –≤–µ—Ç–∫—É –¥–æ —Ñ–∏–Ω–∞–ª–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ ¬´–ó–∞—Å—á–∏—Ç–∞—Ç—å –º–∏—Å—Å–∏—é¬ª, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ä–∞–Ω–≥.</p>
              </div>
              <div class="cb-right">
                <div class="hud-mini">
                  <span class="kbd">Ctrl K</span>
                  <span style="color:var(--muted);">–ø–∞–ª–∏—Ç—Ä–∞</span>
                </div>
                <div class="hud-mini">
                  <span class="kbd">Shift</span>
                  <span style="color:var(--muted);">+ –≤—ã–¥–µ–ª–µ–Ω–∏–µ</span>
                </div>
              </div>
            </div>

          </div>
        </div>
      </section>

</section>

<div class="cinematic-divider" aria-hidden="true">
  <svg viewBox="0 0 1440 120" preserveAspectRatio="none">
    <path class="cd-glow" d="M0,64 C180,96 360,16 540,48 C720,80 900,112 1080,72 C1260,32 1350,40 1440,56 L1440,120 L0,120 Z"></path>
    <path class="cd-line" d="M0,70 C180,102 360,22 540,54 C720,86 900,118 1080,78 C1260,38 1350,46 1440,62"></path>
  </svg>
</div>

      <section id="quiz" class="card" data-kicker="INTERACTIVE">
        <div class="card-inner">
          <div class="kicker">INTERACTIVE ‚Ä¢ TEST</div>
          <h2>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è</h2>

                <div class="quiz-section">
                    <div class="quiz-container">
                        <div id="quizArea">
                            <!-- Quiz questions will be inserted here -->
                        </div>

                        <div class="quiz-buttons">
                            <button class="btn" id="checkBtn" style="display: none;">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                            <button class="btn" id="nextBtn" style="display: none;">–°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å</button>
                        </div>

                        <div class="result" id="result" style="display: none;">
                            <div class="result-score" id="resultScore"></div>
                            <div class="result-message" id="resultMessage"></div>
                            <button class="btn" id="restartBtn" style="margin-top: 2rem;">–ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –∑–∞–Ω–æ–≤–æ</button>
                        </div>
                    </div>
                </div>
          <div class="embed">
            <div class="embed-hd"><span>–°–∏—Å—Ç–µ–º–∞ –∞—á–∏–≤–æ–∫</span><span class="kbd">auto</span></div>
            <div class="embed-bd">
              <p style="margin:0; color: rgba(255,255,255,.72); max-width: 72ch;">
                –ê—á–∏–≤–∫–∏ –≤—ã–¥–∞—é—Ç—Å—è –∑–∞ —á—Ç–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–æ–≤ –∏ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞. –≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–¥—Ö–æ–¥–∞ ‚Äúengagement layer‚Äù –¥–ª—è –ª–æ–Ω–≥—Ä–∏–¥–∞.
              </p>
            </div>
          </div>
        </div>
      </section>

<div class="cinematic-divider" aria-hidden="true">
  <svg viewBox="0 0 1440 120" preserveAspectRatio="none">
    <path class="cd-glow" d="M0,64 C180,96 360,16 540,48 C720,80 900,112 1080,72 C1260,32 1350,40 1440,56 L1440,120 L0,120 Z"></path>
    <path class="cd-line" d="M0,70 C180,102 360,22 540,54 C720,86 900,118 1080,78 C1260,38 1350,46 1440,62"></path>
  </svg>
</div>

      <section id="conclusion" class="card" data-kicker="SUMMARY">
        <div class="card-inner">
          <div class="kicker">SUMMARY ‚Ä¢ TAKEAWAYS</div>
          <h2>–í—ã–≤–æ–¥—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è</h2>

                <div class="effects-grid">
                    <div class="effect-card positive">
                        <h3>–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥</h3>
                        <p>–ò–≥—Ä—ã –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã–º–∏ –ø—Ä–∏ —É–º–µ—Ä–µ–Ω–Ω–æ–º –∏ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ</p>
                    </div>

                    <div class="effect-card negative">
                        <h3>–†–∏—Å–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏</h3>
                        <p>–ß—Ä–µ–∑–º–µ—Ä–Ω–æ–µ —É–≤–ª–µ—á–µ–Ω–∏–µ –∏–≥—Ä–∞–º–∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–º –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è–º</p>
                    </div>
                </div>

                <h3>–û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã:</h3>
                <p>1. –ö–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –∏–≥—Ä—ã –æ–∫–∞–∑—ã–≤–∞—é—Ç –º–Ω–æ–≥–æ–≥—Ä–∞–Ω–Ω–æ–µ –∏ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ —á–µ–ª–æ–≤–µ–∫–∞, —Å–æ—á–µ—Ç–∞—è –∫–∞–∫ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ, —Ç–∞–∫ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã.</p>
                <p>2. –†–∞–∑–Ω—ã–µ –∂–∞–Ω—Ä—ã –∏–≥—Ä –ø–æ-—Ä–∞–∑–Ω–æ–º—É –≤–ª–∏—è—é—Ç –Ω–∞ –∏–≥—Ä–æ–∫–æ–≤: —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–µ –∏–≥—Ä—ã —Ä–∞–∑–≤–∏–≤–∞—é—Ç –º—ã—à–ª–µ–Ω–∏–µ, –∞ –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ - —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞–≤—ã–∫–∏.</p>
                <p>3. –ü—Ä–∏ —É–º–µ—Ä–µ–Ω–Ω–æ–º –∏ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ –∏–≥—Ä—ã –º–æ–≥—É—Ç –ø—Ä–∏–Ω–µ—Å—Ç–∏ –ø–æ–ª—å–∑—É, —Ç–æ–≥–¥–∞ –∫–∞–∫ —á—Ä–µ–∑–º–µ—Ä–Ω–æ–µ —É–≤–ª–µ—á–µ–Ω–∏–µ —Å–æ–∑–¥–∞–µ—Ç —Ä–∏—Å–∫–∏.</p>
                <p>4. –í–∞–∂–Ω–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∑–¥–æ—Ä–æ–≤–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –∏–≥—Ä–∞–º, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∞–∫—Ü–∏–∏.</p>

                <div class="game-info">
                    <h4>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∏–≥—Ä–æ–∫–æ–≤:</h4>
                    <p>‚Ä¢ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ –ª–∏–º–∏—Ç—ã –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –∏–≥—Ä—ã</p>
                    <p>‚Ä¢ –î–µ–ª–∞–π—Ç–µ –ø–µ—Ä–µ—Ä—ã–≤—ã –≤–æ –≤—Ä–µ–º—è –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–≥—Ä–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π</p>
                    <p>‚Ä¢ –†–∞–∑–≤–∏–≤–∞–π—Ç–µ –¥—Ä—É–≥–∏–µ —Ö–æ–±–±–∏ –∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã –ø–æ–º–∏–º–æ –∏–≥—Ä</p>
                    <p>‚Ä¢ –û–±—Ä–∞—â–∞–π—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å–≤–æ–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</p>
                </div>
        </div>
      </section>

<div class="cinematic-divider" aria-hidden="true">
  <svg viewBox="0 0 1440 120" preserveAspectRatio="none">
    <path class="cd-glow" d="M0,64 C180,96 360,16 540,48 C720,80 900,112 1080,72 C1260,32 1350,40 1440,56 L1440,120 L0,120 Z"></path>
    <path class="cd-line" d="M0,70 C180,102 360,22 540,54 C720,86 900,118 1080,78 C1260,38 1350,46 1440,62"></path>
  </svg>
</div>

      <section id="sources" class="card" data-kicker="REFERENCES">
        <div class="card-inner">
          <div class="kicker">REFERENCES ‚Ä¢ LINKS</div>
          <h2>–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∏ —Å—Å—ã–ª–∫–∏</h2>

                <div class="sources">
                    <h3>–ù–∞—É—á–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:</h3>
                    <ul class="source-list">
                        <li>
                            <a href="https://medaboutme.ru/articles/igromaniya_kogda_vrednye_privychki_pererastayut_v_zavisimost/" target="_blank">
                                "–ò–≥—Ä–æ–º–∞–Ω–∏—è: –∫–æ–≥–¥–∞ –≤—Ä–µ–¥–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏ –ø–µ—Ä–µ—Ä–∞—Å—Ç–∞—é—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å" - MedAboutMe
                            </a>
                        </li>
                        <li>
                            <a href="https://newzoo.com/resources?type=trendreports&tag=all" target="_blank">
                                "–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –ø–æ –∏–≥—Ä–æ–≤–æ–π –∏–Ω–¥—É—Å—Ç—Ä–∏–∏" - Newzoo
                            </a>
                        </li>
                        <li>
                            <a href="https://cyberleninka.ru/article/n/rol-kompyuternoy-igry-v-psihologicheskom-razvitie-podrostkov/viewer" target="_blank">
                                "–†–æ–ª—å –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–π –∏–≥—Ä—ã –≤ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º —Ä–∞–∑–≤–∏—Ç–∏–∏ –ø–æ–¥—Ä–æ—Å—Ç–∫–æ–≤" - –ö–∏–±–µ—Ä–õ–µ–Ω–∏–Ω–∫–∞
                            </a>
                        </li>
                    </ul>

                    <h3>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–±—ã–ª–∏ –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ):</h3>
                    <ul class="source-list">
                        <li>
                            <a href="https://store.steampowered.com/app/570/Dota_2/" target="_blank">
                                Dota 2 - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤ Steam Store
                            </a>
                        </li>
                        <li>
                            <a href="https://store.steampowered.com/app/730/CounterStrike_2/" target="_blank">
                                Counter-Strike 2 - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤ Steam Store
                            </a>
                        </li>
                        <li>
                            <a href="https://worldofwarcraft.blizzard.com/ru-ru/" target="_blank">
                                World of Warcraft - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç Blizzard
                            </a>
                        </li>
                    </ul>
                </div>
        </div>
      </section>
    </main>
  </div>

  <div class="toast" id="toast"></div>

  <!-- Settings modal -->
  <div class="overlay" id="settingsOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á—Ç–µ–Ω–∏—è">
      <div class="mh">
        <b>‚öô –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á—Ç–µ–Ω–∏—è –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</b>
        <button class="btn" id="closeSettings" style="flex:0 0 auto;">‚úï</button>
      </div>
      <div class="mb">
        <div class="field">
          <label>–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞</label>
          <div class="row">
            <input type="range" id="fontRange" min="14" max="20" value="16" />
            <span class="kbd"><span id="fontVal">16</span>px</span>
          </div>
          <small>–ò–∑–º–µ–Ω—è–µ—Ç –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –≤—Å–µ—Ö —Å–µ–∫—Ü–∏–π.</small>
        </div>

        <div class="field">
          <label>–®–∏—Ä–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏ (measure)</label>
          <div class="row">
            <input type="range" id="measureRange" min="58" max="86" value="72" />
            <span class="kbd"><span id="measureVal">72</span>ch</span>
          </div>
          <small>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –Ω–∞ –±–æ–ª—å—à–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö.</small>
        </div>

        <div class="field">
          <label>–ü–ª–∞–≤–Ω—ã–π —Å–∫—Ä–æ–ª–ª</label>
          <div class="row">
            <div class="toggle">
              <input type="checkbox" id="smoothToggle" checked />
              <span>Lenis (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)</span>
            </div>
          </div>
          <small>–û—Ç–∫–ª—é—á–∏—Ç–µ, –µ—Å–ª–∏ –µ—Å—Ç—å –ª–∞–≥–∏ –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö.</small>
        </div>

        <div class="field">
          <label>–≠—Ñ—Ñ–µ–∫—Ç—ã / Motion</label>
          <div class="row">
            <div class="toggle">
              <input type="checkbox" id="motionToggle" checked />
              <span>GSAP / 3D / Parallax</span>
            </div>
          </div>
          <small>–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π ‚Äú–≥–µ–π–º–∏–Ω–≥–æ–≤—ã–π‚Äù —Ö–∞—Ä–∞–∫—Ç–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã.</small>
        </div>

        <div class="field" style="grid-column: 1 / -1;">
          <label>–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏</label>
          <p style="margin:0; color: rgba(255,255,255,.74); font-size: 13px;">
            <span class="kbd">Ctrl K</span> –∫–æ–º–∞–Ω–¥–Ω–∞—è –ø–∞–ª–∏—Ç—Ä–∞ ‚Ä¢
            <span class="kbd">/</span> –ø–æ–∏—Å–∫ –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º ‚Ä¢
            <span class="kbd">T</span> –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É ‚Ä¢
            <span class="kbd">S</span> –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Command palette -->
  <div class="overlay" id="paletteOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-label="–ö–æ–º–∞–Ω–¥–Ω–∞—è –ø–∞–ª–∏—Ç—Ä–∞">
      <div class="mh">
        <b>‚åò –ö–æ–º–∞–Ω–¥–Ω–∞—è –ø–∞–ª–∏—Ç—Ä–∞</b>
        <button class="btn" id="closePalette" style="flex:0 0 auto;">‚úï</button>
      </div>
      <div class="mb" style="grid-template-columns: 1fr;">
        <div class="field">
          <label>–ü–æ–∏—Å–∫ / –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Ä–∞–∑–¥–µ–ª—É</label>
          <input id="paletteInput" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ: —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –ø–æ–ª—å–∑–∞, –≤—Ä–µ–¥, –ø—Ä–∏–º–µ—Ä—ã, —Ç–µ—Å—Ç, –≤—ã–≤–æ–¥—ã, –∏—Å—Ç–æ—á–Ω–∏–∫–∏‚Ä¶" 
                 style="width:100%; padding: 12px 12px; border-radius: 14px; border: 1px solid rgba(255,255,255,.12); background: rgba(0,0,0,.28); color: rgba(255,255,255,.88);" />
          <div id="paletteList" style="margin-top: 10px; display:grid; gap: 8px;"></div>
          <small>Enter ‚Äî –ø–µ—Ä–µ–π—Ç–∏ ‚Ä¢ Esc ‚Äî –∑–∞–∫—Ä—ã—Ç—å</small>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ===== Utilities =====
    const $ = (s, p=document) => p.querySelector(s);
    const $$ = (s, p=document) => Array.from(p.querySelectorAll(s));
    const clamp = (n, a, b) => Math.max(a, Math.min(b, n));

    function toast(title, msg, icon="üèÜ") {
      const host = $("#toast");
      if(!host) return;
      const el = document.createElement("div");
      el.className = "toast-item";
      el.innerHTML = `<div class="toast-ic">${icon}</div><div><b>${title}</b><span>${msg}</span></div>`;
      host.appendChild(el);
      setTimeout(() => {
        el.style.opacity = "0";
        el.style.transform = "translateY(8px)";
        setTimeout(() => el.remove(), 260);
      }, 3600);
    }

    // ===== Smooth scroll (Lenis) =====
    let lenis = null;
    function enableLenis(on) {
      try {
        if(!window.Lenis) return;
        if(on && !lenis) {
          lenis = new Lenis({
            duration: 1.05,
            easing: (t) => 1 - Math.pow(1 - t, 3),
            smoothWheel: true
          });
          function raf(time) {
            if(!lenis) return;
            lenis.raf(time);
            requestAnimationFrame(raf);
          }
          requestAnimationFrame(raf);
        } else if(!on && lenis) {
          lenis.destroy();
          lenis = null;
        }
      } catch(e) {}
    }

    // ===== Reading time & density =====
    function computeReading() {
      const text = document.body.innerText || "";
      const words = text.trim().split(/\s+/).filter(Boolean).length;
      const minutes = Math.max(1, Math.round(words / 180)); // ~180 wpm RU
      $("#rtValue").textContent = `${minutes} –º–∏–Ω ‚Ä¢ ${words.toLocaleString("ru-RU")} —Å–ª–æ–≤`;
      $("#densityLabel").textContent = (words > 1700 ? "High" : words > 900 ? "Medium" : "Low");
      return {words, minutes};
    }

    // ===== Progress =====
    function updateProgress() {
      const doc = document.documentElement;
      const scrollTop = doc.scrollTop || document.body.scrollTop;
      const scrollHeight = doc.scrollHeight - doc.clientHeight;
      const pct = scrollHeight ? (scrollTop / scrollHeight) * 100 : 0;
      $("#topProgress").style.width = `${pct}%`;
      $("#progValue").textContent = `${Math.round(pct)}%`;
      $("#radarPct").textContent = `${Math.round(pct)}%`;
      $("#radarBar").style.width = `${pct}%`;
      return pct;
      updateReadMission();

    }

    // ===== TOC active section =====
    const sectionOrder = ["stats","positive","negative","examples","story","quiz","conclusion","sources"];
    const sectionNames = {
      stats: "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞",
      positive: "–ü–æ–ª—å–∑–∞",
      negative: "–í—Ä–µ–¥",
      examples: "–ü—Ä–∏–º–µ—Ä—ã",
      story: "Story Mode",
      quiz: "–¢–µ—Å—Ç",
      conclusion: "–í—ã–≤–æ–¥—ã",
      sources: "–ò—Å—Ç–æ—á–Ω–∏–∫–∏",
    };

    function setActive(id) {
      $$("#toc a").forEach(a => a.classList.toggle("active", a.dataset.id === id));
      $("#secValue").textContent = sectionNames[id] || "‚Äî";
    }

    // ===== Achievements =====
    const achievements = new Set();
    function unlock(key, title, msg, icon="üèÜ") {
      if(achievements.has(key)) return;
      achievements.add(key);
      $("#achValue").textContent = String(achievements.size);
      toast(title, msg, icon);
    }

    // ===== 3D Tilt (desktop only) =====
    function bindTilt() {
      const isFinePointer = matchMedia("(pointer:fine)").matches;
      if(!isFinePointer) return;
      const max = 9;
      const cards = [...$$(".card"), ...$$(".game-card")];
      cards.forEach(card => {
        card.addEventListener("mousemove", (e) => {
          const r = card.getBoundingClientRect();
          const x = (e.clientX - r.left) / r.width;
          const y = (e.clientY - r.top) / r.height;
          const ry = (x - .5) * (max * 2);
          const rx = -(y - .5) * (max * 2);
          card.style.transform = `translateY(-2px) rotateX(${rx.toFixed(2)}deg) rotateY(${ry.toFixed(2)}deg)`;
        });
        card.addEventListener("mouseleave", () => {
          card.style.transform = "";
        });
      });
    }

    // ===== Chart.js (Stats) =====
    let hoursChart = null;
    function initChart() {
      if(!window.Chart) return;
      const ctx = $("#hoursChart");
      if(!ctx) return;

      const base = 7;
      const data = (v) => ([
        {label: "–ò–≥—Ä—ã", value: v},
        {label: "–î—Ä—É–≥–æ–µ —Ö–æ–±–±–∏", value: Math.max(0, base - Math.max(0, v - base))},
        {label: "–°–æ–Ω (–≤ –Ω–µ–¥–µ–ª—é)", value: 56}, // 8h/day
      ]);

      const series = data(base);

      hoursChart = new Chart(ctx, {
        type: "bar",
        data: {
          labels: series.map(s => s.label),
          datasets: [{
            label: "–ß–∞—Å—ã",
            data: series.map(s => s.value),
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                label: (c) => `${c.raw} —á`
              }
            }
          },
          scales: {
            x: {
              ticks: { color: "rgba(255,255,255,.72)" },
              grid: { color: "rgba(255,255,255,.06)" }
            },
            y: {
              beginAtZero: true,
              ticks: { color: "rgba(255,255,255,.72)" },
              grid: { color: "rgba(255,255,255,.06)" }
            }
          }
        }
      });

      const range = $("#hoursRange");
      const out = $("#hoursVal");
      range?.addEventListener("input", () => {
        const v = Number(range.value);
        out.textContent = String(v);
        const s = data(v);
        hoursChart.data.labels = s.map(x => x.label);
        hoursChart.data.datasets[0].data = s.map(x => x.value);
        hoursChart.update();
        if(v >= 14) unlock("hours14", "–ê—á–∏–≤–∫–∞: –ù–∞—Å—ã—â–µ–Ω–Ω–∞—è –Ω–µ–¥–µ–ª—è", "14+ —á–∞—Å–æ–≤ –∏–≥—Ä –≤ –Ω–µ–¥–µ–ª—é ‚Äî —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –±–∞–ª–∞–Ω—Å–æ–º.", "‚ö†Ô∏è");
      });
    }

    // ===== Risk simulator =====
    function initRisk() {
      const range = $("#riskRange");
      const out = $("#riskVal");
      const bar = $("#riskBar");
      const pct = $("#riskPct");
      const text = $("#riskText");

      function render(v) {
        const risk = clamp((v*v) * 8, 0, 100); // simple curve
        out.textContent = String(v);
        bar.style.width = `${risk}%`;
        pct.textContent = `${Math.round(risk)}%`;
        const band =
          risk < 18 ? {"t":"–ù–∏–∑–∫–∏–π. –ï—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å–æ–Ω/—É—á—ë–±–∞/—Ä–∞–±–æ—Ç–∞ –∏ –æ–±—â–µ–Ω–∏–µ ‚Äî —Ä–∏—Å–∫ –º–∏–Ω–∏–º–∞–ª–µ–Ω.", "c":"rgba(52,211,153,.14)"} :
          risk < 45 ? {"t":"–£–º–µ—Ä–µ–Ω–Ω—ã–π. –ü–æ—è–≤–ª—è–µ—Ç—Å—è —à–∞–Ω—Å —Å–º–µ—â–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –≤ —Å—Ç–æ—Ä–æ–Ω—É –∏–≥—Ä—ã.", "c":"rgba(251,191,36,.12)"} :
          risk < 75 ? {"t":"–í—ã—Å–æ–∫–∏–π. –í–µ—Ä–æ—è—Ç–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å–æ —Å–Ω–æ–º/–æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞–º–∏/–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ–º.", "c":"rgba(251,113,133,.12)"} :
                      {"t":"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π. –ù—É–∂–Ω—ã –∂—ë—Å—Ç–∫–∏–µ –ª–∏–º–∏—Ç—ã –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞.", "c":"rgba(251,113,133,.18)"};
        text.textContent = band.t;
        text.style.background = band.c;
        text.style.padding = "10px 12px";
        text.style.borderRadius = "14px";
        text.style.border = "1px solid rgba(255,255,255,.10)";
      }

      range?.addEventListener("input", () => {
        const v = Number(range.value);
        render(v);
        if(v >= 6) unlock("risk6", "–ê—á–∏–≤–∫–∞: –ö—Ä–∞—Å–Ω–∞—è –∑–æ–Ω–∞", "6+ —á–∞—Å–æ–≤ –≤ –¥–µ–Ω—å ‚Äî –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –Ω–∞—Ä—É—à–∏—Ç—å —Ä–µ–∂–∏–º –∏ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞.", "üß®");
      });
      render(Number(range?.value || 2));
    }

    // ===== Filter game cards =====
    function initFilters() {
      const buttons = $$("#filters [data-filter]");
      const cards = $$(".game-card");
      if(!buttons.length || !cards.length) return;

      function classify(card) {
        const t = card.innerText.toLowerCase();
        const pos = ["—Ä–∞–∑–≤–∏—Ç–∏–µ","–∫–æ–º–∞–Ω–¥","–º—ã—à–ª–µ–Ω","—Ä–µ–∞–∫—Ü","—Å–æ—Ü–∏–∞–ª"].some(k => t.includes(k));
        const neg = ["–∑–∞–≤–∏—Å–∏–º","—Å—Ç—Ä–µ—Å—Å","—Ç–æ–∫—Å","–∞–≥—Ä–µ—Å—Å","–≤—Ä–µ–º"].some(k => t.includes(k));
        return {pos, neg};
      }

      const meta = new Map(cards.map(c => [c, classify(c)]));
      buttons.forEach(btn => {
        btn.addEventListener("click", () => {
          const f = btn.dataset.filter;
          buttons.forEach(b => b.classList.remove("primary"));
          btn.classList.add("primary");
          cards.forEach(c => {
            const m = meta.get(c);
            const show =
              f === "all" ? true :
              f === "positive" ? (m.pos && !m.neg) || (m.pos && m.neg) :
              f === "negative" ? (m.neg) : true;
            c.style.display = show ? "" : "none";
          });
          unlock("filter", "–ê—á–∏–≤–∫–∞: –ê–Ω–∞–ª–∏—Ç–∏–∫", "–í—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Ñ–∏–ª—å—Ç—Ä –ø–æ —ç—Ñ—Ñ–µ–∫—Ç–∞–º.", "üß†");
        });
      });
    }

    // ===== Quiz (upgrade) =====
    const quizData = [
      {
        question: "–ö–∞–∫–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç –∏–≥—Ä–æ–∫–æ–≤ –≤ –º–∏—Ä–µ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤–∑—Ä–æ—Å–ª–æ–µ –Ω–∞—Å–µ–ª–µ–Ω–∏–µ?",
        options: ["46%", "58%", "71%", "83%"],
        correct: 2
      },
      {
        question: "–ö–∞–∫–æ–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –æ–∫–∞–∑—ã–≤–∞—é—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–µ –∏–≥—Ä—ã?",
        options: [
          "–£—Ö—É–¥—à–∞—é—Ç –ø–∞–º—è—Ç—å",
          "–†–∞–∑–≤–∏–≤–∞—é—Ç –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ",
          "–°–Ω–∏–∂–∞—é—Ç —Ä–µ–∞–∫—Ü–∏—é",
          "–í—ã–∑—ã–≤–∞—é—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å"
        ],
        correct: 1
      },
      {
        question: "–°–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤ –≤ –Ω–µ–¥–µ–ª—é –≤ —Å—Ä–µ–¥–Ω–µ–º —Ç—Ä–∞—Ç–∏—Ç –∏–≥—Ä–æ–∫ (–ø–æ —Ç–µ–∫—Å—Ç—É –≤ —Ä–∞–∑–¥–µ–ª–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏)?",
        options: ["2 —á–∞—Å–∞", "7 —á–∞—Å–æ–≤", "14 —á–∞—Å–æ–≤", "21 —á–∞—Å"],
        correct: 1
      },
      {
        question: "–ß—Ç–æ –≤–∞–∂–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –∑–¥–æ—Ä–æ–≤–æ–≥–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∫ –∏–≥—Ä–∞–º (–≤ –≤—ã–≤–æ–¥–∞—Ö)?",
        options: [
          "–¢–æ–ª—å–∫–æ —É—Ä–æ–≤–µ–Ω—å –Ω–∞–≤—ã–∫–∞",
          "–¢–æ–ª—å–∫–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥",
          "–í—Ä–µ–º—è –∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∞–∫—Ü–∏–∏",
          "–¢–æ–ª—å–∫–æ –≤—ã–±–æ—Ä –∂–∞–Ω—Ä–∞"
        ],
        correct: 2
      }
    ];

    let quizIdx = 0;
    let quizScore = 0;
    let answered = false;

    function renderQuiz() {
      const area = $("#quizArea");
      const checkBtn = $("#checkBtn");
      const nextBtn = $("#nextBtn");
      const result = $("#result");
      const restartBtn = $("#restartBtn");

      if(!area) return;

      if(quizIdx >= quizData.length) {
        area.innerHTML = "";
        result.style.display = "";
        $("#resultScore").textContent = `–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${quizScore} / ${quizData.length}`;
        const msg =
          quizScore === quizData.length ? "–û—Ç–ª–∏—á–Ω–æ. –í—ã –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—á–∏—Ç–∞–ª–∏ –º–∞—Ç–µ—Ä–∏–∞–ª." :
          quizScore >= Math.ceil(quizData.length * .65) ? "–•–æ—Ä–æ—à–æ. –ï—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∏–µ –ø—Ä–æ–±–µ–ª—ã ‚Äî –ø—Ä–æ–ª–∏—Å—Ç–∞–π—Ç–µ –Ω—É–∂–Ω—ã–µ —Å–µ–∫—Ü–∏–∏." :
          "–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–µ—á–∏—Ç–∞—Ç—å –∫–ª—é—á–µ–≤—ã–µ —Ä–∞–∑–¥–µ–ª—ã –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —Ç–µ—Å—Ç.";
        $("#resultMessage").textContent = msg;
        checkBtn.style.display = "none";
        nextBtn.style.display = "none";
        unlock("quiz_done", "–ê—á–∏–≤–∫–∞: –¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω", "–í—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç.", "‚úÖ");
        if(quizScore === quizData.length) unlock("quiz_perfect", "–ê—á–∏–≤–∫–∞: Perfect", "100% –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤.", "üåü");
        return;
      }

      const q = quizData[quizIdx];
      area.innerHTML = `
        <div class="quiz-q">${quizIdx+1}/${quizData.length} ‚Äî ${q.question}</div>
        <div id="quizOpts">
          ${q.options.map((o,i)=>`
            <label class="quiz-opt" data-i="${i}">
              <input type="radio" name="q" value="${i}" />
              <div>${o}</div>
            </label>
          `).join("")}
        </div>
      `;
      result.style.display = "none";
      checkBtn.style.display = "";
      nextBtn.style.display = "none";
      answered = false;

      // clickable options
      $$("#quizOpts .quiz-opt").forEach(opt => {
        opt.addEventListener("click", () => {
          const r = opt.querySelector("input");
          r.checked = true;
        });
      });

      checkBtn.onclick = () => {
        if(answered) return;
        const selected = $("#quizOpts input[name='q']:checked");
        if(!selected) {
          toast("–¢–µ—Å—Ç", "–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞.", "üéÆ");
          return;
        }
        const val = Number(selected.value);
        const opts = $$("#quizOpts .quiz-opt");
        opts.forEach(o => o.classList.remove("correct","wrong"));
        opts[q.correct].classList.add("correct");
        if(val !== q.correct) {
          opts[val].classList.add("wrong");
        } else {
          quizScore += 1;
        }
        answered = true;
        nextBtn.style.display = "";
      };

      nextBtn.onclick = () => {
        if(!answered) return;
        quizIdx += 1;
        renderQuiz();
      };

      restartBtn.onclick = () => {
        quizIdx = 0;
        quizScore = 0;
        renderQuiz();
      };
    }

    // ===== Motion (GSAP) =====
    function initMotion(on=true) {
      if(!on) return;
      if(!window.gsap || !window.ScrollTrigger) return;
      gsap.registerPlugin(ScrollTrigger);

      // section reveal
      $$(".card").forEach((card, idx) => {
        gsap.fromTo(card, {
          y: 24, opacity: 0
        }, {
          y: 0, opacity: 1, duration: .6, ease: "power2.out",
          scrollTrigger: {
            trigger: card,
            start: "top 80%",
            once: true
          }
        });
      });

      // stat count-up
      $$(".stat-number").forEach((el) => {
        const raw = el.textContent.trim();
        const num = parseFloat(raw.replace(/[^0-9.]/g,""));
        const suffix = raw.replace(/[0-9.]/g,"").trim();
        if(!isFinite(num)) return;
        el.dataset.raw = raw;
        el.textContent = "0" + (suffix ? " " + suffix : "");
        ScrollTrigger.create({
          trigger: el,
          start: "top 85%",
          once: true,
          onEnter: () => {
            gsap.to({v:0}, {
              v: num,
              duration: 1.1,
              ease: "power3.out",
              onUpdate: function() {
                const v = this.targets()[0].v;
                const txt = (num >= 100 ? Math.round(v) : v.toFixed(1)).replace(".0","");
                el.textContent = txt + (suffix ? " " + suffix : "");
              }
            });
          }
        });
      });
    }

    // ===== WebGL background (Three.js) =====
    function initWebGL(on=true) {
      if(!on) return;
      if(!window.THREE) return;

      const canvas = $("#bg3d");
      const renderer = new THREE.WebGLRenderer({ canvas, antialias: true, alpha: true });
      renderer.setPixelRatio(Math.min(window.devicePixelRatio || 1, 2));
      renderer.setSize(window.innerWidth, window.innerHeight);

      const scene = new THREE.Scene();
      const camera = new THREE.PerspectiveCamera(55, window.innerWidth/window.innerHeight, 0.1, 100);
      camera.position.set(0, 0, 6);

      const group = new THREE.Group();
      scene.add(group);

      const count = 1400;
      const geom = new THREE.BufferGeometry();
      const pos = new Float32Array(count * 3);
      const col = new Float32Array(count * 3);

      function rand(a,b) { return a + Math.random()*(b-a); }

      for(let i=0;i<count;i++) {
        pos[i*3+0] = rand(-6,6);
        pos[i*3+1] = rand(-4,4);
        pos[i*3+2] = rand(-6,6);
        // pseudo gradient colors
        const t = Math.random();
        const c1 = new THREE.Color(0x7c3aed);
        const c2 = new THREE.Color(0x22d3ee);
        const c3 = new THREE.Color(0xfb7185);
        const mix = c1.clone().lerp(c2, t*0.7).lerp(c3, Math.max(0, t-0.6));
        col[i*3+0] = mix.r;
        col[i*3+1] = mix.g;
        col[i*3+2] = mix.b;
      }

      geom.setAttribute("position", new THREE.BufferAttribute(pos, 3));
      geom.setAttribute("color", new THREE.BufferAttribute(col, 3));

      const mat = new THREE.PointsMaterial({
        size: 0.035,
        vertexColors: true,
        transparent: true,
        opacity: 0.85,
        depthWrite: false
      });
      const points = new THREE.Points(geom, mat);
      group.add(points);

      let mx = 0, my = 0;
      window.addEventListener("mousemove", (e) => {
        mx = (e.clientX / window.innerWidth) * 2 - 1;
        my = (e.clientY / window.innerHeight) * 2 - 1;
      }, { passive: true });

      function onResize() {
        renderer.setSize(window.innerWidth, window.innerHeight);
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
      }
      window.addEventListener("resize", onResize);

      let t = 0;
      function tick() {
        t += 0.0035;
        group.rotation.y = t * 0.35 + mx * 0.08;
        group.rotation.x = t * 0.22 - my * 0.06;
        group.position.x = mx * 0.12;
        group.position.y = -my * 0.10;
        renderer.render(scene, camera);
        requestAnimationFrame(tick);
      }
      tick();
    }

    // ===== Modals / Palette =====
    const settingsOverlay = $("#settingsOverlay");
    const paletteOverlay = $("#paletteOverlay");
    const paletteInput = $("#paletteInput");
    const paletteList = $("#paletteList");

    function openOverlay(el) {
      el.classList.add("show");
      el.setAttribute("aria-hidden", "false");
    }
    function closeOverlay(el) {
      el.classList.remove("show");
      el.setAttribute("aria-hidden", "true");
    }

    function buildPalette(filter="") {
      const f = filter.trim().toLowerCase();
      const items = sectionOrder
        .map(id => ({ id, name: sectionNames[id] }))
        .filter(x => !f || x.name.toLowerCase().includes(f) || x.id.includes(f));

      paletteList.innerHTML = items.map(x => `
        <button class="btn" data-go="${x.id}" style="justify-content: space-between;">
          <span>${x.name}</span>
          <span class="kbd">#${x.id}</span>
        </button>
      `).join("");

      $$("[data-go]", paletteList).forEach(btn => {
        btn.addEventListener("click", () => {
          const id = btn.dataset.go;
          closeOverlay(paletteOverlay);
          document.querySelector("#"+id)?.scrollIntoView({behavior:"smooth", block:"start"});
        });
      });
    }

    function openPalette() {
      buildPalette("");
      openOverlay(paletteOverlay);
      setTimeout(() => paletteInput?.focus(), 30);
    }

    // ===== Theme toggle =====
    let theme = "neon";
    function setTheme(next) {
      theme = next;
      const root = document.documentElement;
      if(theme === "mono") {
        root.style.setProperty("--brand", "#a3a3a3");
        root.style.setProperty("--brand2", "#e5e7eb");
        $("#toggleThemeBtn").textContent = "–¢–µ–º–∞: Mono";
      } else {
        root.style.setProperty("--brand", "#7c3aed");
        root.style.setProperty("--brand2", "#22d3ee");
        $("#toggleThemeBtn").textContent = "–¢–µ–º–∞: Neon";
      }
      unlock("theme", "–ê—á–∏–≤–∫–∞: –°–∫–∏–Ω –∏–∑–º–µ–Ω—ë–Ω", `–¢–µ–º–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞: ${theme}.`, "üé®");
    }


    // ===== Ultra v2: Missions / Rank =====
    const PROG_KEY = "gaming_longread_progress_v2";
    const defaultProg = { read60:false, story:false, quiz:false, story_claimed:false };
    function loadProg(){
      try { return Object.assign({}, defaultProg, JSON.parse(localStorage.getItem(PROG_KEY) || "{}")); }
      catch(e){ return Object.assign({}, defaultProg); }
    }
    function saveProg(p){ localStorage.setItem(PROG_KEY, JSON.stringify(p)); }
    let prog = loadProg();

    function computeRank(){
      const done = [prog.read60, prog.story, prog.quiz].filter(Boolean).length;
      const badge = done === 3 ? "Legend"
                  : done === 2 ? "Diamond"
                  : done === 1 ? "Bronze"
                  : "Recruit";
      $("#rankValue").textContent = badge;
      $("#rankBadge").textContent = badge;
      $("#rankSub").textContent = `${done}/3 –º–∏—Å—Å–∏–π`;
      // mark mission cards
      const setDone = (sel, ok) => {
        const el = document.querySelector(sel);
        if(!el) return;
        el.classList.toggle("done", !!ok);
      };
      setDone('.mission[data-m="read"]', prog.read60);
      setDone('.mission[data-m="story"]', prog.story);
      setDone('.mission[data-m="quiz"]', prog.quiz);

      return { done, badge };
    }

    function setMission(key, value=true){
      prog[key] = !!value;
      saveProg(prog);
      computeRank();
    }

    // patch unlock to also advance missions
    const _unlock = unlock;
    unlock = function(key, title, msg, icon="üèÜ"){
      _unlock(key, title, msg, icon);
      if(key === "quiz_done") setMission("quiz", true);
      if(key === "story_done") setMission("story", true);
    };

    // ===== Callout toggles =====
    function initCallouts(){
      $$(".callout").forEach(c => {
        const btn = c.querySelector(".callout-toggle");
        const body = c.querySelector(".callout-body");
        if(!btn || !body) return;
        btn.addEventListener("click", () => {
          const open = body.hasAttribute("hidden");
          if(open){ body.removeAttribute("hidden"); btn.setAttribute("aria-expanded","true"); btn.textContent = "–°–∫—Ä—ã—Ç—å"; }
          else { body.setAttribute("hidden",""); btn.setAttribute("aria-expanded","false"); btn.textContent = "–ü–æ–∫–∞–∑–∞—Ç—å"; }
          unlock("callout", "–ê—á–∏–≤–∫–∞: –¢–µ—Ö—Ä–∞–∑–±–æ—Ä", "–í—ã —Ä–∞—Å–∫—Ä—ã–ª–∏ –±–ª–æ–∫ —Å –º–µ—Ç–æ–¥–∏–∫–æ–π.", "üß©");
        });
      });
    }

    // ===== Pull quote actions =====
    function initPullQuotes(){
      $$(".pq-copy").forEach(btn => {
        btn.addEventListener("click", async () => {
          const t = btn.dataset.copy || "";
          try { await navigator.clipboard.writeText(t); toast("–¶–∏—Ç–∞—Ç–∞", "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞.", "üìå"); }
          catch(e){ toast("–¶–∏—Ç–∞—Ç–∞", "–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞.", "‚ö†Ô∏è"); }
          unlock("quote", "–ê—á–∏–≤–∫–∞: –¶–∏—Ç–∞—Ç–∞", "–í—ã —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏ –º—ã—Å–ª—å –∏–∑ –ª–æ–Ω–≥—Ä–∏–¥–∞.", "üìå");
        });
      });
      $$(".pq-share").forEach(btn => {
        btn.addEventListener("click", async () => {
          const hash = btn.dataset.share || "#top";
          const url = location.origin + location.pathname + hash;
          try { await navigator.clipboard.writeText(url); toast("–°—Å—ã–ª–∫–∞", "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ.", "üîó"); }
          catch(e){ toast("–°—Å—ã–ª–∫–∞", "–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å.", "‚ö†Ô∏è"); }
        });
      });
    }

    // ===== Highlight-to-share =====
    function initHighlightShare(){
      const fab = $("#shareFab");
      const fabBtn = $("#shareFabBtn");
      if(!fab || !fabBtn) return;

      let lastSel = "";
      const hide = () => { fab.classList.remove("show"); fab.setAttribute("aria-hidden","true"); };
      const show = (x, y) => {
        fab.style.left = Math.max(12, Math.min(window.innerWidth - 220, x)) + "px";
        fab.style.top  = Math.max(12, Math.min(window.innerHeight - 80, y)) + "px";
        fab.classList.add("show");
        fab.setAttribute("aria-hidden","false");
      };

      document.addEventListener("selectionchange", () => {
        const sel = String(window.getSelection()?.toString() || "").trim();
        if(sel && sel.length >= 14){
          lastSel = sel.length > 240 ? sel.slice(0,240) + "‚Ä¶" : sel;
          const r = window.getSelection().getRangeAt(0).getBoundingClientRect();
          show(r.left + r.width/2, r.top - 50);
        } else {
          lastSel = "";
          hide();
        }
      });

      fabBtn.addEventListener("click", async () => {
        if(!lastSel) return;
        const url = location.href.split("#")[0] + (location.hash || "#top");
        const payload = `‚Äú${lastSel}‚Äù\n\n${url}`;
        try { await navigator.clipboard.writeText(payload); toast("–ü–æ–¥–µ–ª–∏—Ç—å—Å—è", "–¶–∏—Ç–∞—Ç–∞ + —Å—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã.", "üöÄ"); }
        catch(e){ toast("–ü–æ–¥–µ–ª–∏—Ç—å—Å—è", "–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å.", "‚ö†Ô∏è"); }
        unlock("share", "–ê—á–∏–≤–∫–∞: –®–µ—Ä–∏–Ω–≥", "–í—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ —Ü–∏—Ç–∞—Ç—É –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏.", "üöÄ");
        hide();
      });

      document.addEventListener("scroll", () => fab.classList.contains("show") && hide(), { passive:true });
      document.addEventListener("click", (e) => {
        if(fab.contains(e.target)) return;
        if(window.getSelection()?.toString()?.trim()) return;
        hide();
      });
    }

    // ===== Story Mode =====
    const storyNodes = {
      start: {
        title: "–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫: —Å—Ç–∞—Ä—Ç –Ω–µ–¥–µ–ª–∏",
        text: "–£—Ç—Ä–æ. –£ –≤–∞—Å —É—á—ë–±–∞/—Ä–∞–±–æ—Ç–∞, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∏–ª–∏ –¥–µ–¥–ª–∞–π–Ω—ã. –í–µ—á–µ—Ä–æ–º —Ö–æ—á–µ—Ç—Å—è –ø–æ–∏–≥—Ä–∞—Ç—å. –ö–∞–∫ –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –¥–µ–Ω—å?",
        choices: [
          { title:"–†–µ–∂–∏–º –±–∞–ª–∞–Ω—Å–∞", meta:"+—Å–æ–Ω +–∫–æ–Ω—Ç—Ä–æ–ª—å", delta:{sleep:+1, hours:1, stress:-1, control:+2}, next:"mid" },
          { title:"–°–Ω–∞—á–∞–ª–∞ –¥–µ–ª–∞, –ø–æ—Ç–æ–º –∫–æ—Ä–æ—Ç–∫–∞—è —Å–µ—Å—Å–∏—è", meta:"+–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞", delta:{sleep:0, hours:2, stress:0, control:+1}, next:"mid" },
          { title:"–ò–≥—Ä–∞—Ç—å –¥–æ –ø–æ–∑–¥–Ω–µ–π –Ω–æ—á–∏", meta:"+—á–∞—Å—ã -—Å–æ–Ω", delta:{sleep:-2, hours:4, stress:+1, control:-2}, next:"mid" },
        ]
      },
      mid: {
        title: "–°—Ä–µ–¥–∞: –ø–µ—Ä–≤–∞—è —Ç—É—Ä–±—É–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å",
        text: "–ü–æ—Å–ª–µ –ø–∞—Ä—ã –º–∞—Ç—á–µ–π –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ –∏–∑‚Äë–∑–∞ –ø–æ—Ä–∞–∂–µ–Ω–∏–π. –ö–æ–º–∞–Ω–¥–∞ ¬´–Ω–µ —Ç—è–Ω–µ—Ç¬ª, —Ö–æ—á–µ—Ç—Å—è ¬´–æ—Ç—ã–≥—Ä–∞—Ç—å—Å—è¬ª. –ß—Ç–æ –≤—ã –¥–µ–ª–∞–µ—Ç–µ?",
        choices: [
          { title:"–î–µ–ª–∞—é –ø–∞—É–∑—É –∏ –≤—ã—Ö–æ–∂—É", meta:"+—Å–∞–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—å", delta:{sleep:+1, hours:-1, stress:-2, control:+2}, next:"late" },
          { title:"–ú–µ–Ω—è—é —Ä–µ–∂–∏–º: –µ—â—ë 1‚Äì2 –∏–≥—Ä—ã", meta:"–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ", delta:{sleep:0, hours:+1, stress:+1, control:0}, next:"late" },
          { title:"–î–æ–∂–∏–º–∞—é –¥–æ –ø–æ–±–µ–¥—ã –ª—é–±–æ–π —Ü–µ–Ω–æ–π", meta:"+—Å—Ç—Ä–µ—Å—Å +—á–∞—Å—ã", delta:{sleep:-1, hours:+3, stress:+3, control:-2}, next:"late" },
        ]
      },
      late: {
        title: "–ü—è—Ç–Ω–∏—Ü–∞: —Å–æ—Ü–∏–∞–ª—å–Ω—ã–π —Ñ–∞–∫—Ç–æ—Ä",
        text: "–î—Ä—É–∑—å—è –∑–æ–≤—É—Ç –Ω–∞ –≤–µ—á–µ—Ä. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∏–≤–µ–Ω—Ç –≤ –∏–≥—Ä–µ —Å –Ω–∞–≥—Ä–∞–¥–∞–º–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏. –í—ã –≤—ã–±–∏—Ä–∞–µ—Ç–µ:",
        choices: [
          { title:"–ò–¥—É –∫ –¥—Ä—É–∑—å—è–º, –∏–≤–µ–Ω—Ç ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ", meta:"+—Å–æ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å +–±–∞–ª–∞–Ω—Å", delta:{sleep:+1, hours:1, stress:-1, control:+2}, next:"end" },
          { title:"–û—Å—Ç–∞—é—Å—å –¥–æ–º–∞, –Ω–æ —Å—Ç–∞–≤–ª—é –ª–∏–º–∏—Ç", meta:"+–≥—Ä–∞–Ω–∏—Ü—ã", delta:{sleep:0, hours:+2, stress:0, control:+1}, next:"end" },
          { title:"–ü–æ–ª–Ω–æ—Å—Ç—å—é —É—Ö–æ–∂—É –≤ –∏–≤–µ–Ω—Ç", meta:"—Ä–∏—Å–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏", delta:{sleep:-2, hours:+4, stress:+2, control:-2}, next:"end" },
        ]
      },
      end: {
        title: "–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ: –∏—Ç–æ–≥",
        text: "–ù–µ–¥–µ–ª—è –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è. –ü–æ—Ä–∞ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥—ã: —á—Ç–æ —É—Å–∏–ª–∏–≤–∞–µ—Ç –ø–æ–ª—å–∑—É, –∞ —á—Ç–æ –ø–æ–≤—ã—à–∞–µ—Ç —Ä–∏—Å–∫–∏.",
        choices: []
      }
    };

    const storyState = {
      node:"start",
      path:[],
      sleep:7,
      hours:0,
      stress:2,
      control:2
    };

    function storyRisk(){
      // demo model: higher with hours, stress, low sleep/control
      const s = Math.max(4, Math.min(9, storyState.sleep));
      const h = Math.max(0, Math.min(10, storyState.hours));
      const st = Math.max(0, Math.min(10, storyState.stress));
      const c = Math.max(0, Math.min(6, storyState.control));
      const risk = (h*1.2) + (st*1.1) + ((7 - s)*1.6) + ((3 - c)*1.3);
      return Math.max(0, Math.min(100, Math.round(risk*6)));
    }

    function storyBalanceLabel(){
      const r = storyRisk();
      if(r <= 22) return "–°—Ç–∞–±–∏–ª—å–Ω—ã–π";
      if(r <= 45) return "–ù–∞–ø—Ä—è–∂—ë–Ω–Ω—ã–π";
      if(r <= 68) return "–†–∏—Å–∫–æ–≤–∞–Ω–Ω—ã–π";
      return "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π";
    }

    function storyTip(){
      const r = storyRisk();
      if(r <= 22) return "–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ª–∏–º–∏—Ç—ã –∏ –ø–∞—É–∑—ã –ø–æ—Å–ª–µ —Å–µ—Ä–∏–∏ –º–∞—Ç—á–µ–π.";
      if(r <= 45) return "–î–æ–±–∞–≤—å—Ç–µ —Å–æ–Ω –∏ —á—ë—Ç–∫–∏–π —Å—Ç–æ–ø‚Äë—Å–∏–≥–Ω–∞–ª (2 –ø–æ—Ä–∞–∂–µ–Ω–∏—è –ø–æ–¥—Ä—è–¥ ‚Üí –ø–µ—Ä–µ—Ä—ã–≤).";
      if(r <= 68) return "–°–æ–∫—Ä–∞—Ç–∏—Ç–µ –≤–µ—á–µ—Ä–Ω–∏–µ —Å–µ—Å—Å–∏–∏, —É–±–µ—Ä–∏—Ç–µ ¬´–æ—Ç—ã–≥—Ä—ã—à¬ª –∫–∞–∫ —Ç—Ä–∏–≥–≥–µ—Ä, –ø–ª–∞–Ω–∏—Ä—É–π—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã.";
      return "–ù—É–∂–Ω—ã –∂—ë—Å—Ç–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã: –ª–∏–º–∏—Ç –≤—Ä–µ–º–µ–Ω–∏, –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ñ–ª–∞–π–Ω‚Äë—Ä—É—Ç–∏–Ω.";
    }

    function storyRender(){
      const n = storyNodes[storyState.node];
      if(!n) return;
      $("#storyText").textContent = `${n.title}. ${n.text}`;
      $("#storyStepLabel").textContent = `#${storyState.path.length+1}`;
      $("#stSleep").textContent = `${storyState.sleep}—á`;
      $("#stHours").textContent = `${storyState.hours}—á`;
      $("#stStress").textContent = String(storyState.stress);
      $("#stRisk").textContent = `${storyRisk()}%`;

      const choices = $("#storyChoices");
      const finishBtn = $("#storyFinishBtn");

      if(n.choices.length === 0){
        choices.innerHTML = `
          <div class="choice" style="cursor:default;">
            <div class="c-title">–§–∏–Ω–∞–ª –≤–µ—Ç–∫–∏</div>
            <div class="c-meta">–ù–∞–∂–º–∏—Ç–µ ¬´–ó–∞–≤–µ—Ä—à–∏—Ç—å –≤–µ—Ç–∫—É¬ª, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ä–∞–∑–±–æ—Ä –∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç.</div>
          </div>
        `;
        finishBtn.disabled = false;
        return;
      }

      finishBtn.disabled = true;
      choices.innerHTML = n.choices.map((c, i)=>`
        <div class="choice" data-i="${i}">
          <div class="c-title">${c.title}</div>
          <div class="c-meta">
            <span>–≠—Ñ—Ñ–µ–∫—Ç: ${c.meta}</span>
            <span>Œî—Å–æ–Ω ${c.delta.sleep>=0?"+":""}${c.delta.sleep}</span>
            <span>Œî–∏–≥—Ä—ã ${c.delta.hours>=0?"+":""}${c.delta.hours}</span>
            <span>Œî—Å—Ç—Ä–µ—Å—Å ${c.delta.stress>=0?"+":""}${c.delta.stress}</span>
          </div>
        </div>
      `).join("");

      $$(".choice", choices).forEach(el => {
        el.addEventListener("click", () => {
          const i = Number(el.dataset.i);
          const c = n.choices[i];
          if(!c) return;
          // update state
          storyState.path.push({ node: storyState.node, choice: c.title });
          storyState.sleep = Math.max(4, Math.min(9, storyState.sleep + (c.delta.sleep||0)));
          storyState.hours = Math.max(0, Math.min(12, storyState.hours + (c.delta.hours||0)));
          storyState.stress = Math.max(0, Math.min(10, storyState.stress + (c.delta.stress||0)));
          storyState.control = Math.max(0, Math.min(6, storyState.control + (c.delta.control||0)));
          storyState.node = c.next;
          storyUpdatePath();
          storyRender();
          unlock("story_step", "Story Mode", "–í—ã —Å–¥–µ–ª–∞–ª–∏ –≤—ã–±–æ—Ä –≤ —Å—Ü–µ–Ω–∞—Ä–∏–∏.", "üïπÔ∏è");
        });
      });
    }

    function storyUpdatePath(){
      const out = $("#storyPath");
      if(!out) return;
      out.innerHTML = storyState.path.slice(-5).map((x, idx)=>`
        <div class="path-item">
          <b>${idx+1}. ${storyNodes[x.node].title}</b>
          <div style="color:var(--muted); font-size:12px; margin-top:4px;">${x.choice}</div>
        </div>
      `).join("") || `<div class="path-item"><b>–°—Ç–∞—Ä—Ç</b><div style="color:var(--muted); font-size:12px; margin-top:4px;">–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç.</div></div>`;
    }

    function storyBack(){
      if(storyState.path.length === 0) return;
      // soft back: reset and replay path except last
      const keep = storyState.path.slice(0, -1);
      storyReset();
      for(const step of keep){
        const node = storyNodes[storyState.node];
        const c = node.choices.find(x => x.title === step.choice);
        if(!c) continue;
        storyState.path.push({ node: storyState.node, choice: c.title });
        storyState.sleep = Math.max(4, Math.min(9, storyState.sleep + (c.delta.sleep||0)));
        storyState.hours = Math.max(0, Math.min(12, storyState.hours + (c.delta.hours||0)));
        storyState.stress = Math.max(0, Math.min(10, storyState.stress + (c.delta.stress||0)));
        storyState.control = Math.max(0, Math.min(6, storyState.control + (c.delta.control||0)));
        storyState.node = c.next;
      }
      storyUpdatePath();
      storyRender();
    }

    function storyReset(){
      storyState.node="start";
      storyState.path=[];
      storyState.sleep=7;
      storyState.hours=0;
      storyState.stress=2;
      storyState.control=2;
      $("#storyResult").style.display = "none";
      $("#storyFinishBtn").disabled = true;
      storyUpdatePath();
      storyRender();
    }

    function storyFinish(){
      // show summary
      const r = storyRisk();
      $("#storyResult").style.display = "";
      $("#storySummary").textContent =
        `–í–∞—à –±–∞–ª–∞–Ω—Å: ${storyBalanceLabel()}. –ò—Ç–æ–≥–æ–≤—ã–π —Ä–∏—Å–∫ –ø–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏: ${r}%. ${storyTip()}`;
      $("#resBalance").textContent = storyBalanceLabel();
      $("#resRisk").textContent = `${r}%`;
      $("#resTip").textContent = storyTip().slice(0, 44) + (storyTip().length>44?"‚Ä¶":"");
      unlock("story_done", "–ê—á–∏–≤–∫–∞: Story Mode", "–í—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏ —Å—Ü–µ–Ω–∞—Ä–∏–π.", "üïπÔ∏è");
    }

    function initStory(){
      if(!$("#storyText")) return;
      storyUpdatePath();
      storyRender();

      $("#storyBackBtn")?.addEventListener("click", storyBack);
      $("#storyRestartBtn")?.addEventListener("click", () => { storyReset(); toast("Story Mode","–°—Ü–µ–Ω–∞—Ä–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω.","‚Ü∫"); });
      $("#storyFinishBtn")?.addEventListener("click", storyFinish);

      $("#storyClaimBtn")?.addEventListener("click", () => {
        setMission("story", true);
        prog.story_claimed = true;
        saveProg(prog);
        toast("–ú–∏—Å—Å–∏—è", "Story Mode –∑–∞—Å—á–∏—Ç–∞–Ω. –†–∞–Ω–≥ –æ–±–Ω–æ–≤–ª—ë–Ω.", "üèÖ");
      });
    }

    // ===== Reading mission (60%) =====
    function updateReadMission(){
      const pct = parseInt($("#progValue")?.textContent || "0", 10) || 0;
      $("#mRead").textContent = pct + "%";
      if(pct >= 60 && !prog.read60){
        setMission("read60", true);
        unlock("read60", "–ê—á–∏–≤–∫–∞: 60%", "–í—ã –ø—Ä–æ—à–ª–∏ –æ—Å–Ω–æ–≤–Ω—É—é —á–∞—Å—Ç—å –ª–æ–Ω–≥—Ä–∏–¥–∞.", "üìà");
      }
    }

    // ===== Reset progress =====
    function initResetProgress(){
      $("#resetProgressBtn")?.addEventListener("click", () => {
        localStorage.removeItem(PROG_KEY);
        prog = loadProg();
        computeRank();
        toast("–ü—Ä–æ–≥—Ä–µ—Å—Å", "–õ–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å —Å–±—Ä–æ—à–µ–Ω.", "üßπ");
      });
    }


    // ===== Init =====
    window.addEventListener("DOMContentLoaded", () => {
      computeReading();
      updateProgress();

      computeReading();
      updateProgress();
      computeRank();
      initCallouts();
      initPullQuotes();
      initHighlightShare();
      initStory();
      initResetProgress();
      updateReadMission();

      // default smooth scroll
      enableLenis(true);

      // Bind UI
      $("#startBtn").addEventListener("click", () => {
        document.querySelector("#stats")?.scrollIntoView({behavior:"smooth", block:"start"});
        unlock("start", "–ê—á–∏–≤–∫–∞: –í—Ö–æ–¥ –≤ —Ä–µ–π–¥", "–í—ã –Ω–∞—á–∞–ª–∏ —á—Ç–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞.", "üöÄ");
      });
      $("#jumpToRead").addEventListener("click", () => {
        document.querySelector("#stats")?.scrollIntoView({behavior:"smooth", block:"start"});
      });
      $("#settingsBtn").addEventListener("click", () => openOverlay(settingsOverlay));
      $("#closeSettings").addEventListener("click", () => closeOverlay(settingsOverlay));
      $("#paletteBtn").addEventListener("click", () => openPalette());
      $("#closePalette").addEventListener("click", () => closeOverlay(paletteOverlay));
      $("#toggleThemeBtn").addEventListener("click", () => setTheme(theme === "neon" ? "mono" : "neon"));

      settingsOverlay.addEventListener("click", (e) => {
        if(e.target === settingsOverlay) closeOverlay(settingsOverlay);
      });
      paletteOverlay.addEventListener("click", (e) => {
        if(e.target === paletteOverlay) closeOverlay(paletteOverlay);
      });

      // Settings controls
      const fontRange = $("#fontRange");
      const fontVal = $("#fontVal");
      const measureRange = $("#measureRange");
      const measureVal = $("#measureVal");
      const smoothToggle = $("#smoothToggle");
      const motionToggle = $("#motionToggle");

      fontRange.addEventListener("input", () => {
        const v = Number(fontRange.value);
        document.documentElement.style.setProperty("--fs", v + "px");
        fontVal.textContent = String(v);
        computeReading();
      });
      measureRange.addEventListener("input", () => {
        const v = Number(measureRange.value);
        document.documentElement.style.setProperty("--measure", v + "ch");
        measureVal.textContent = String(v);
      });
      smoothToggle.addEventListener("change", () => {
        enableLenis(smoothToggle.checked);
      });

      // Motion toggles apply only at init time for simplicity
      let motionEnabled = true;
      motionToggle.addEventListener("change", () => {
        motionEnabled = motionToggle.checked;
        toast("–ù–∞—Å—Ç—Ä–æ–π–∫–∏", motionEnabled ? "Motion –≤–∫–ª—é—á—ë–Ω." : "Motion –æ—Ç–∫–ª—é—á—ë–Ω (–æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞).", "‚öôÔ∏è");
      });

      // Palette search
      paletteInput.addEventListener("input", () => buildPalette(paletteInput.value));
      paletteInput.addEventListener("keydown", (e) => {
        if(e.key === "Escape") closeOverlay(paletteOverlay);
        if(e.key === "Enter") {
          const first = $("[data-go]", paletteList);
          if(first) first.click();
        }
      });

      // TOC smooth scroll (Lenis-compatible)
      $$("#toc a").forEach(a => {
        a.addEventListener("click", (e) => {
          e.preventDefault();
          const id = a.getAttribute("href").slice(1);
          document.getElementById(id)?.scrollIntoView({behavior:"smooth", block:"start"});
        });
      });

      // Scroll spy / achievements
      const io = new IntersectionObserver((entries) => {
        entries.forEach(en => {
          if(en.isIntersecting) {
            const id = en.target.id;
            setActive(id);
            unlock("visit_"+id, "–ê—á–∏–≤–∫–∞: –†–∞–∑–¥–µ–ª –æ—Ç–∫—Ä—ã—Ç", sectionNames[id], "üß≠");
          }
        });
      }, { threshold: 0.45 });

      sectionOrder.forEach(id => {
        const el = document.getElementById(id);
        if(el) io.observe(el);
      });

      // Progress updates
      window.addEventListener("scroll", () => {
        const pct = updateProgress();
        if(pct > 80) unlock("deep", "–ê—á–∏–≤–∫–∞: –ì–ª—É–±–æ–∫–æ–µ —á—Ç–µ–Ω–∏–µ", "–í—ã –¥–æ—à–ª–∏ –¥–æ 80% –ª–æ–Ω–≥—Ä–∏–¥–∞.", "üìö");
      }, { passive: true });

      // Init interactive modules
      bindTilt();
      initChart();
      initRisk();
      initFilters();
      renderQuiz();

      // Motion / WebGL
      initMotion(true);
      initWebGL(true);

      // Keyboard shortcuts
      window.addEventListener("keydown", (e) => {
        const tag = (e.target && e.target.tagName) ? e.target.tagName.toLowerCase() : "";
        const inInput = ["input","textarea"].includes(tag);

        if(e.key === "Escape") {
          closeOverlay(settingsOverlay);
          closeOverlay(paletteOverlay);
        }
        if(e.ctrlKey && e.key.toLowerCase() === "k") {
          e.preventDefault();
          openPalette();
        }
        if(!inInput && e.key === "/") {
          e.preventDefault();
          openPalette();
          setTimeout(() => {
            paletteInput.value = "";
            buildPalette("");
            paletteInput.focus();
          }, 30);
        }
        if(!inInput && e.key.toLowerCase() === "s") {
          openOverlay(settingsOverlay);
        }
        if(!inInput && e.key.toLowerCase() === "t") {
          setTheme(theme === "neon" ? "mono" : "neon");
        }
      });

      // Initial active
      setActive("stats");
      unlock("boot", "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è", "–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –º–æ–¥—É–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã.", "‚ö°");
    });
  </script>
</body>
</html>
